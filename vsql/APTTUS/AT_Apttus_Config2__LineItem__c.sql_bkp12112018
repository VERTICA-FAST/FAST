/****
****Script Name	  : AT_Apttus_Config2__LineItem__c.sql
****Description   : Incremental data load for AT_Apttus_Config2__LineItem__c
****/

/* Setting timing on**/
\timing

\set ON_ERROR_STOP on

CREATE LOCAL TEMP TABLE Start_Time_Tmp ON COMMIT PRESERVE ROWS AS select count(*) count, sysdate st from "swt_rpt_stg"."AT_Apttus_Config2__LineItem__c";

/* Inserting values into the Audit table  */
INSERT INTO swt_rpt_stg.FAST_LD_AUDT
(
SUBJECT_AREA
,TBL_NM
,LD_DT
,START_DT_TIME
,END_DT_TIME
,SRC_REC_CNT
,TGT_REC_CNT
,COMPLTN_STAT
)
select 'APTTUS','AT_Apttus_Config2__LineItem__c',sysdate::date,sysdate,null,(select count from Start_Time_Tmp) ,null,'N';

Commit;  

INSERT /*+DIRECT*/ INTO "swt_rpt_stg".AT_Apttus_Config2__LineItem__c_Hist select * from "swt_rpt_stg".AT_Apttus_Config2__LineItem__c;
COMMIT;

CREATE LOCAL TEMP TABLE duplicates_records ON COMMIT PRESERVE ROWS AS (
select id,max(auto_id) as auto_id from swt_rpt_stg.AT_Apttus_Config2__LineItem__c where id in (
select id from swt_rpt_stg.AT_Apttus_Config2__LineItem__c group by id,LASTMODIFIEDDATE having count(1)>1)
group by id);


delete from swt_rpt_stg.AT_Apttus_Config2__LineItem__c where exists(
select 1 from duplicates_records t2 where swt_rpt_stg.AT_Apttus_Config2__LineItem__c.id=t2.id and swt_rpt_stg.AT_Apttus_Config2__LineItem__c.auto_id<t2.auto_id);

commit;
  
CREATE LOCAL TEMP TABLE AT_Apttus_Config2__LineItem__c_stg_Tmp ON COMMIT PRESERVE ROWS AS
( 
SELECT DISTINCT * FROM swt_rpt_stg.AT_Apttus_Config2__LineItem__c)
SEGMENTED BY HASH(ID,LASTMODIFIEDDATE) ALL NODES;

TRUNCATE TABLE swt_rpt_stg.AT_Apttus_Config2__LineItem__c;
  
CREATE LOCAL TEMP TABLE AT_Apttus_Config2__LineItem__c_base_Tmp ON COMMIT PRESERVE ROWS AS
( 
SELECT DISTINCT ID,LASTMODIFIEDDATE FROM swt_rpt_base.AT_Apttus_Config2__LineItem__c)
SEGMENTED BY HASH(ID,LASTMODIFIEDDATE) ALL NODES;


CREATE LOCAL TEMP TABLE AT_Apttus_Config2__LineItem__c_stg_Tmp_Key ON COMMIT PRESERVE ROWS AS
(
SELECT id, max(lastmodifieddate) as lastmodifieddate FROM AT_Apttus_Config2__LineItem__c_stg_Tmp group by id) 
SEGMENTED BY HASH(ID,LASTMODIFIEDDATE) ALL NODES;
  

/* Inserting Stage table data into Historical Table */

insert /*+DIRECT*/ into swt_rpt_stg.AT_Apttus_Config2__LineItem__c_Hist
(
Id
,Apttus_Config2__AssetId__c
,Apttus_Config2__AssetLineItemId__c
,SWT_Asset_Line_Item__c
,Apttus_Config2__AttributeValueId__c
,Apttus_Config2__BaseProductId__c
,Apttus_Config2__ClassificationId__c
,Apttus_Config2__ChargeGroupId__c
,Apttus_Config2__CollaborationRequestId__c
,Apttus_Config2__ConfigurationId__c
,Apttus_Config2__DerivedFromId__c
,SWT_Education_Approval_Check_1__c
,Apttus_Config2__IncentiveId__c
,SWT_Is_Premier_Support__c
,Is_VSOE_Less_And_Support__c
,SWT_Is_VSOE_less_than_lower_band__c
,SWT_License_Discount_90__c
,Apttus_Config2__OptionId__c
,SWT_OrangeThresholdCheck__c
,SWT_OrangeThresholdCheckForSupport__c
,SWT_ParentLineItem__c
,SWT_Percentage_of_License_Net__c
,Apttus_Config2__PriceListItemId__c
,Apttus_Config2__ProductId__c
,Apttus_Config2__ProductOptionId__c
,SWT_Promotion__c
,SWT_PS_Level_2_Approval_Check__c
,SWT_PS_Level_3_Approval_Check__c
,SWT_RedThresholdCheck__c
,SWT_RedThresholdCheckForSupport__c
,RedThresholdCheckL3__c
,RedThresholdCheckL4__c
,SWT_SAAS_Approvals_Check__c
,SWT_Saas_L2_Approvals_Check__c
,SAAS_L4_BU_GM_Approval__c
,Apttus_Config2__ServiceLocationId__c
,Apttus_Config2__SummaryGroupId__c
,Apttus_Config2__TaxCodeId__c
,SWT_Term_Range__c
,SWT_Total_Discount_Percentage__c
,Apttus_Config2__AdHocGroupId__c
,Apttus_Config2__TransferPriceLineItemId__c
,SW_UpfrontBilling__c
,SWT_YellowThresholdCheck__c
,SWT_YellowThresholdCheckForSupport__c
,Apttus_Config2__RelatedItemId__c
,CreatedById
,CurrencyIsoCode
,LastModifiedbyId
,Name
,Apttus_Config2__AddedBy__c
,Apttus_Config2__AddedByRuleInfo__c
,SWT_Additional_Adjustment_Type__c
,SWT_Additional_Discount__c
,SWT_Additional_Discount_Percentage__c
,Apttus_Config2__AdjustedPrice__c
,Apttus_Config2__AdjustmentAmount__c
,Apttus_Config2__AdjustmentType__c
,SWT_Advanced_Support_Resource__c
,Agreement_Bypass__c
,Apttus_Config2__AllocateGroupAdjustment__c
,Apttus_Config2__AllowableAction__c
,Apttus_Config2__AllowManualAdjustment__c
,Apttus_Config2__AllowProration__c
,Apttus_Config2__AllowRemoval__c
,SWT_Approval_Required__c
,Apttus_CQApprov__Approval_Status__c
,SWT_Asset_Line_Item_ID__c
,SWT_Asset_LI_Quantity_Check__c
,Apttus_Config2__AssetQuantity__c
,SWT_Authority_Currency_Code__c
,Apttus_Config2__AutoRenew__c
,Apttus_Config2__AutoRenewalTerm__c
,Apttus_Config2__AutoRenewalType__c
,Apttus_Config2__BaseCost__c
,Apttus_Config2__BaseCostOverride__c
,Apttus_Config2__BaseExtendedCost__c
,Apttus_Config2__BaseExtendedPrice__c
,Apttus_Config2__BasePrice__c
,Apttus_Config2__BasePriceOverride__c
,Apttus_Config2__BasePriceMethod__c
,Apttus_Config2__BillingFrequency__c
,Apttus_Config2__BillingPreferenceId__c
,Apttus_Config2__BillingRule__c
,Apttus_Config2__BillToAccountId__c
,SWT_Business_Area__c
,SWT_Cart_Total_License_List_Price__c
,SWT_Cascade_Support_Discount__c
,Apttus_Config2__ClassificationHierarchy__c
,Apttus_Config2__ClassificationHierarchyInfo__c
,SWT_Channel_CMT_MD_Lead_Queue__c
,SWT_Channel_Manager_Queue__c
,Apttus_Config2__ChargeType__c
,SWT_CMT_MD_Lead_Queue__c
,Apttus_Config2__Comments__c
,Apttus_Config2__CommitmentQuantity__c
,Apttus_Config2__ConfigStatus__c
,Apttus_Config2__ConstraintCheckStatus__c
,Apttus_Config2__ContractNumbers__c
,SWT_Contractual_Discount_Amount__c
,SWT_Contractual_Discount_Percentage__c
,Apttus_Config2__CopySourceBundleNumber__c
,Apttus_Config2__CopySourceLineNumber__c
,Apttus_Config2__CopySourceNumber__c
,Apttus_Config2__Cost__c
,Apttus_Config2__CouponCode__c
,SWT_CSR_Approvals__c
,SWT_CSR_Compensation__c
,SWT_CSR_Routed__c
,Apttus_Config2__Customizable__c
,SWT_Deal_Desk__c
,Apttus_Config2__DeltaPrice__c
,Apttus_Config2__DeltaQuantity__c
,Apttus_Config2__Description__c
,SWT_Discounting_Band__c
,SWT_Discounting_Threshold__c
,Apttus_Config2__EndDate__c
,Apttus_Config2__ExtendedCost__c
,Apttus_Config2__ExtendedDescription__c
,SWT_Extended_List_Price__c
,Apttus_Config2__ExtendedPrice__c
,Apttus_Config2__ExtendedQuantity__c
,SWT_First_Line_Manager_Queue__c
,Apttus_Config2__FlatOptionPrice__c
,Apttus_Config2__GroupAdjustmentPercent__c
,Apttus_Config2__Guidance__c
,Apttus_Config2__HasAttributes__c
,Apttus_Config2__HasBaseProduct__c
,Apttus_Config2__HasDefaults__c
,Apttus_Config2__HasIncentives__c
,Apttus_Config2__HasOptions__c
,Apttus_Config2__HasTieredPrice__c
,Apttus_Config2__HideCopyAction__c
,Apttus_Config2__HideInvoiceDisplay__c
,SWT_HPE_Grace_Period__c
,SWT_HPE_RampUp__c
,Apttus_Config2__IncentiveAdjustmentAmount__c
,Apttus_Config2__IncentiveBasePrice__c
,Apttus_Config2__IncentiveCode__c
,Apttus_Config2__IncentiveExtendedPrice__c
,Apttus_Config2__IncentiveType__c
,Apttus_Config2__IsAssetPricing__c
,SWT_Is_Complex_Promotion_Applied__c
,Apttus_Config2__IsCustomPricing__c
,Apttus_Config2__IsHidden__c
,Apttus_Config2__IsOptionRollupLine__c
,Apttus_Config2__IsPrimaryLine__c
,Apttus_Config2__IsPrimaryRampLine__c
,Apttus_Config2__IsQuantityModifiable__c
,Apttus_Config2__IsReadOnly__c
,Apttus_Config2__IsSellingTermReadOnly__c
,Apttus_Config2__IsUsageTierModifiable__c
,Apttus_Config2__ItemSequence__c
,SWT_Jurisdiction_Text__c
,SWT_Level_1_Approver__c
,SWT_Level_2_Approver__c
,SWT_Level_3_Approver__c
,SWT_Level_4_Approver__c
,SWT_Level_5_Approver__c
,SWT_Level_6_Approver__c
,SWT_LineItem_Update__c
,Apttus_Config2__LineNumber__c
,Apttus_Config2__LineSequence__c
,Apttus_Config2__LineStatus__c
,Apttus_Config2__LineType__c
,Apttus_Config2__ListPrice__c
,SWT_List_Price__c
,Apttus_Config2__LocationId__c
,SWT_Manual_Config_Check__c
,SWT_Manual_Pricing__c
,SWT_Manual_VSOE__c
,Apttus_Config2__MaxPrice__c
,Apttus_Config2__MaxUsageQuantity__c
,Apttus_Config2__MinMaxPriceAppliesTo__c
,Apttus_Config2__MinPrice__c
,Apttus_Config2__MinUsageQuantity__c
,Apttus_Config2__NetAdjustmentPercent__c
,Apttus_Config2__NetPrice__c
,SWT_Net_Price__c
,Apttus_Config2__NetUnitPrice__c
,SWT_Net_Unit_Price__c
,SWT_Non_Discountable_SKU__c
,SWT_Not_For_Resale__c
,SWT_Oppty_Owner_Manager__c
,Apttus_Config2__OptionCost__c
,Apttus_Config2__OptionGroupLabel__c
,Apttus_Config2__OptionPrice__c
,Apttus_Config2__OptionSequence__c
,SWT_Orange_Band_Threshold__c
,SWT_O_Threshold_for_Display__c
,SWT_Overage_Type__c
,Apttus_Config2__ParentBundleNumber__c
,SWT_Partner_Discount_Amount__c
,SWT_Partner_Discount_Percentage__c
,Apttus_Config2__PaymentTermId__c
,Apttus_Config2__RelatedPercent__c
,Apttus_Config2__RelatedPercentAppliesTo__c
,Apttus_Config2__PriceAdjustment__c
,Apttus_Config2__PriceAdjustmentAmount__c
,Apttus_Config2__PriceAdjustmentAppliesTo__c
,Apttus_Config2__PriceAdjustmentType__c
,Apttus_Config2__PriceGroup__c
,Apttus_Config2__PriceIncludedInBundle__c
,Apttus_Config2__PriceListId__c
,Apttus_Config2__PriceMethod__c
,Apttus_Config2__PriceType__c
,Apttus_Config2__PricingDate__c
,Apttus_Config2__Frequency__c
,Apttus_Config2__PricingGuidance__c
,SWT_Pricing_Method__c
,Apttus_Config2__PricingStatus__c
,Apttus_Config2__PricingSteps__c
,Apttus_Config2__Term__c
,Apttus_Config2__PriceUom__c
,Apttus_Config2__PrimaryLineNumber__c
,SWT_Product_Config_Type__c
,SWT_Product_Name_on_Template__c
,SWT_ProductRatePlanChargeID__c
,SWT_Product_Sub_Type__c
,SWT_Product_Type__c
,SWT_Product_Type_Business__c
,SWT_ProductTypeForApprovals__c
,Apttus_Config2__Uom__c
,Apttus_Config2__ProductVersion__c
,SWT_Promotional_Discount_Percentage__c
,SWT_Promotion_Discount_Amount__c
,SWT_PS_Level_2_Queue__c
,Apttus_Config2__Quantity__c
,SWT_Quantity__c
,SWT_Quote__c
,SWT_Quote_Billing_Frequency__c
,SWT_Quote_Sub_Type__c
,SWT_Quote_Type__c
,SWT_Red_Band_Threshold__c
,Apttus_Config2__RelatedAdjustmentAmount__c
,Apttus_Config2__RelatedAdjustmentAppliesTo__c
,Apttus_Config2__RelatedAdjustmentType__c
,SWT_RelatedProduct__c
,SWT_Related_Quantity__c
,Apttus_Config2__RenewalAdjustmentAmount__c
,Apttus_Config2__RenewalAdjustmentType__c
,Apttus_Config2__RollupPriceMethod__c
,Apttus_Config2__RollupPriceToBundle__c
,SWT_R_Threshold_for_Display__c
,Apttus_Config2__SellingFrequency__c
,Apttus_Config2__SellingTerm__c
,SWT_Selling_Term__c
,Apttus_Config2__ShipToAccountId__c
,SWT_Ship_To_Address__c
,SWT_Sold_By_Pack__c
,Apttus_Config2__StartDate__c
,Apttus_Config2__StatusDetails__c
,SWT_Subscription_Asset_Qty__c
,SWT_Support_Error__c
,Support_Term__c
,Apttus_Config2__SyncStatus__c
,Apttus_Config2__Taxable__c
,SWT_Tax_Amount__c
,SWT_Tax_Code__c
,Apttus_Config2__TaxInclusive__c
,SWT_Tax_Rate__c
,SWT_Tax_Type__c
,SWT_Tier_Type_Formula__c
,SWT_Total_Discount_Value__c
,SWT_Total_Discount_Amount__c
,Apttus_Config2__TotalQuantity__c
,Apttus_Config2__UnitCostAdjustment__c
,Apttus_Config2__UnitPriceAdjustmentAuto__c
,Apttus_Config2__UnitPriceAdjustmentManual__c
,SWT_Uom__c
,swt_uom_soldbyquantity__c
,SWT_UnitOfMeasure__c
,SWT_USDListPrice__c
,SWT_USDNetPrice__c
,SWT_VSOE_Approval_Indicator__c
,SWT_VSOE_lower_band__c
,SWT_VSOE_Module__c
,SWT_VSOE_upper_band__c
,SWT_VSOE_Value__c
,SWT_VSOE_Value_Pricing__c
,SWT_Yellow_Band_Threshold__c
,SWT_ZuoraProductRatePlanID__c
,LastModifiedDate
,SWT_Support_Net_Price__c
,SWT_License_Net_Price__c
,SWT_Support_List_Price__c
,SWT_License_List_Price__c
,SWT_Customer_Account_Reference__c
,SWT_Entitlement_Id__c
,SWT_Y_Threshold_for_Display__c
,SWT_Previous_Year_License_Net_Price__c
,SWT_Previous_Year_Support_Net_Price__c
,SWT_Legacy_SAID__c
,SWT_IsListBasePriceZero__c
,SWT_Price_For_Calculation__c
,SWT_Support_Business_Area__c
,SWT_Product_Tax_Code__c
,SWT_Expected_Start_Date__c
,SWT_Program_Discount_Amount__c
,SWT_Program_Discount_Percentage__c
,SWT_Quantity_Reduced__c
,SWT_Is_Quantity_Reduced__c
,SWT_Asset_Product_Code__c
,SWT_Zuora_Rate_Plan_Charge_ID__c
,SWT_Renewal_Status__c
,SWT_Cancellation_Type__c
,SWT_Cancellation_Reason__c
,SWT_Cancellation_Note__c
,SWT_Product_Code__c
,SWT_has_stackable_promotion__c
,SWT_Is_ChannelFulfilled__c
,SWT_Additional_Discount_Threshold__c
,SWT_Approval_Required_Check__c
,SWT_Approval_Required_Purchase_Type__c
,SWT_Approval_Required_Region__c
,SWT_Discount_Threshold_Check__c
,SWT_Manual_Config_Check_Purchase_Type__c
,SWT_Manual_Config_Check_Region__c
,SWT_Manual_Config_Required_Check__c
,SWT_Quote_Region__c
,SWT_Recommended_Quantity__c
,SWT_Initial_Zuora_Rate_Plan_Charge_ID__c
,SWT_SmartDiscount_Link__c
,SWT_SmartDiscount_Match__c
,SWT_New_Line_Item__c
,SWT_Initial_Quantity_New_Business__c
,SWT_Associated_Cancelled_Asset__c
,SWT_Support_Level__c
,SWT_Billing_Plan__c
,SWT_Mass_Update__c
,SWT_Is_Quantity_Extended__c
,SWT_Custom_Asset_Line_Item_ID__c
,SWT_Product_Detail_Code__c
,SWT_UOM_code__c
,SWT_Education_Cancellation_Reason__c
,SWT_Asset_Quantity__c
,SWT_RenewalCurrentListPrice__c
,SWT_Renewal_Adjustment_Percentage__c
,SWT_Renewal_Adjustment_Amount__c
,SWT_Is_Renewed_Migrated__c
,SWT_Expected_Unit_Price_for_Renewals__c
,SWT_Previous_Year_Unit_Net_Price__c
,SWT_Upgrade_TradeIN_SKU__c
,SWT_Upgrade_TradeIn_Price__c
,SWT_Quote_Country__c
,SWT_Renewing_EL_Product__c
,SWT_Initial_Product_before_Migration__c
,SWT_List_Price_Rounded__c
,SWT_No_Run_Education_Pricing__c
,SWT_RenewalAdditionalDiscountPercentage__c
,SWT_RenewalAdditionalAdjustmentType__c
,SWT_RenewalAdditionalDiscount__c
,SWT_migration_type__c
,SWT_Migration_Flag__c
,SWT_Constraint_Rule_Skip__c
,SWT_Is_Product_Renewable__c
,SWT_ELA_Complimentary__c
,SWT_Product_Billing_Plan__c
,SWT_SupportLevelOfProduct__c
,SWT_Charge_Description__c
,SWT_Skip_Constraint_Rules_For_Assets__c
,IsDeleted
,RecordTypeId
,CreatedDate
,SystemModstamp
,LastActivityDate
,SWT_VSOE__c
,SWT_Go_To_Market_Route__c
,SWT_Expected_End_Date__c
,SWT_Skip_Constraint_Rule_Check__c
,SWT_Original_Quantity__c
,Apttus_Config2__CollaborationParentLineNumber__c
,Apttus_Config2__IsOptional__c
,SWT_Zuora_Subscription_Rate_Plan_ID__c
,SWT_Appliance_Serial_Number__c
,SWT_Discount_Level__c
,SWT_CartExtendedListPrice__c
,SWT_RenewalAdditionalDiscountPercentVal__c
,SWT_Line_Type__c
,SWT_Control_Tower_ID__c
,SWT_Termination_Quantity__c
,SWT_InitialBillingFrequency__c
,LD_DT
,SWT_INS_DT
,d_source
)
select 
Id
,Apttus_Config2__AssetId__c
,Apttus_Config2__AssetLineItemId__c
,SWT_Asset_Line_Item__c
,Apttus_Config2__AttributeValueId__c
,Apttus_Config2__BaseProductId__c
,Apttus_Config2__ClassificationId__c
,Apttus_Config2__ChargeGroupId__c
,Apttus_Config2__CollaborationRequestId__c
,Apttus_Config2__ConfigurationId__c
,Apttus_Config2__DerivedFromId__c
,SWT_Education_Approval_Check_1__c
,Apttus_Config2__IncentiveId__c
,SWT_Is_Premier_Support__c
,Is_VSOE_Less_And_Support__c
,SWT_Is_VSOE_less_than_lower_band__c
,SWT_License_Discount_90__c
,Apttus_Config2__OptionId__c
,SWT_OrangeThresholdCheck__c
,SWT_OrangeThresholdCheckForSupport__c
,SWT_ParentLineItem__c
,SWT_Percentage_of_License_Net__c
,Apttus_Config2__PriceListItemId__c
,Apttus_Config2__ProductId__c
,Apttus_Config2__ProductOptionId__c
,SWT_Promotion__c
,SWT_PS_Level_2_Approval_Check__c
,SWT_PS_Level_3_Approval_Check__c
,SWT_RedThresholdCheck__c
,SWT_RedThresholdCheckForSupport__c
,RedThresholdCheckL3__c
,RedThresholdCheckL4__c
,SWT_SAAS_Approvals_Check__c
,SWT_Saas_L2_Approvals_Check__c
,SAAS_L4_BU_GM_Approval__c
,Apttus_Config2__ServiceLocationId__c
,Apttus_Config2__SummaryGroupId__c
,Apttus_Config2__TaxCodeId__c
,SWT_Term_Range__c
,SWT_Total_Discount_Percentage__c
,Apttus_Config2__AdHocGroupId__c
,Apttus_Config2__TransferPriceLineItemId__c
,SW_UpfrontBilling__c
,SWT_YellowThresholdCheck__c
,SWT_YellowThresholdCheckForSupport__c
,Apttus_Config2__RelatedItemId__c
,CreatedById
,CurrencyIsoCode
,LastModifiedbyId
,Name
,Apttus_Config2__AddedBy__c
,Apttus_Config2__AddedByRuleInfo__c
,SWT_Additional_Adjustment_Type__c
,SWT_Additional_Discount__c
,SWT_Additional_Discount_Percentage__c
,Apttus_Config2__AdjustedPrice__c
,Apttus_Config2__AdjustmentAmount__c
,Apttus_Config2__AdjustmentType__c
,SWT_Advanced_Support_Resource__c
,Agreement_Bypass__c
,Apttus_Config2__AllocateGroupAdjustment__c
,Apttus_Config2__AllowableAction__c
,Apttus_Config2__AllowManualAdjustment__c
,Apttus_Config2__AllowProration__c
,Apttus_Config2__AllowRemoval__c
,SWT_Approval_Required__c
,Apttus_CQApprov__Approval_Status__c
,SWT_Asset_Line_Item_ID__c
,SWT_Asset_LI_Quantity_Check__c
,Apttus_Config2__AssetQuantity__c
,SWT_Authority_Currency_Code__c
,Apttus_Config2__AutoRenew__c
,Apttus_Config2__AutoRenewalTerm__c
,Apttus_Config2__AutoRenewalType__c
,Apttus_Config2__BaseCost__c
,Apttus_Config2__BaseCostOverride__c
,Apttus_Config2__BaseExtendedCost__c
,Apttus_Config2__BaseExtendedPrice__c
,Apttus_Config2__BasePrice__c
,Apttus_Config2__BasePriceOverride__c
,Apttus_Config2__BasePriceMethod__c
,Apttus_Config2__BillingFrequency__c
,Apttus_Config2__BillingPreferenceId__c
,Apttus_Config2__BillingRule__c
,Apttus_Config2__BillToAccountId__c
,SWT_Business_Area__c
,SWT_Cart_Total_License_List_Price__c
,SWT_Cascade_Support_Discount__c
,Apttus_Config2__ClassificationHierarchy__c
,Apttus_Config2__ClassificationHierarchyInfo__c
,SWT_Channel_CMT_MD_Lead_Queue__c
,SWT_Channel_Manager_Queue__c
,Apttus_Config2__ChargeType__c
,SWT_CMT_MD_Lead_Queue__c
,Apttus_Config2__Comments__c
,Apttus_Config2__CommitmentQuantity__c
,Apttus_Config2__ConfigStatus__c
,Apttus_Config2__ConstraintCheckStatus__c
,Apttus_Config2__ContractNumbers__c
,SWT_Contractual_Discount_Amount__c
,SWT_Contractual_Discount_Percentage__c
,Apttus_Config2__CopySourceBundleNumber__c
,Apttus_Config2__CopySourceLineNumber__c
,Apttus_Config2__CopySourceNumber__c
,Apttus_Config2__Cost__c
,Apttus_Config2__CouponCode__c
,SWT_CSR_Approvals__c
,SWT_CSR_Compensation__c
,SWT_CSR_Routed__c
,Apttus_Config2__Customizable__c
,SWT_Deal_Desk__c
,Apttus_Config2__DeltaPrice__c
,Apttus_Config2__DeltaQuantity__c
,Apttus_Config2__Description__c
,SWT_Discounting_Band__c
,SWT_Discounting_Threshold__c
,Apttus_Config2__EndDate__c
,Apttus_Config2__ExtendedCost__c
,Apttus_Config2__ExtendedDescription__c
,SWT_Extended_List_Price__c
,Apttus_Config2__ExtendedPrice__c
,Apttus_Config2__ExtendedQuantity__c
,SWT_First_Line_Manager_Queue__c
,Apttus_Config2__FlatOptionPrice__c
,Apttus_Config2__GroupAdjustmentPercent__c
,Apttus_Config2__Guidance__c
,Apttus_Config2__HasAttributes__c
,Apttus_Config2__HasBaseProduct__c
,Apttus_Config2__HasDefaults__c
,Apttus_Config2__HasIncentives__c
,Apttus_Config2__HasOptions__c
,Apttus_Config2__HasTieredPrice__c
,Apttus_Config2__HideCopyAction__c
,Apttus_Config2__HideInvoiceDisplay__c
,SWT_HPE_Grace_Period__c
,SWT_HPE_RampUp__c
,Apttus_Config2__IncentiveAdjustmentAmount__c
,Apttus_Config2__IncentiveBasePrice__c
,Apttus_Config2__IncentiveCode__c
,Apttus_Config2__IncentiveExtendedPrice__c
,Apttus_Config2__IncentiveType__c
,Apttus_Config2__IsAssetPricing__c
,SWT_Is_Complex_Promotion_Applied__c
,Apttus_Config2__IsCustomPricing__c
,Apttus_Config2__IsHidden__c
,Apttus_Config2__IsOptionRollupLine__c
,Apttus_Config2__IsPrimaryLine__c
,Apttus_Config2__IsPrimaryRampLine__c
,Apttus_Config2__IsQuantityModifiable__c
,Apttus_Config2__IsReadOnly__c
,Apttus_Config2__IsSellingTermReadOnly__c
,Apttus_Config2__IsUsageTierModifiable__c
,Apttus_Config2__ItemSequence__c
,SWT_Jurisdiction_Text__c
,SWT_Level_1_Approver__c
,SWT_Level_2_Approver__c
,SWT_Level_3_Approver__c
,SWT_Level_4_Approver__c
,SWT_Level_5_Approver__c
,SWT_Level_6_Approver__c
,SWT_LineItem_Update__c
,Apttus_Config2__LineNumber__c
,Apttus_Config2__LineSequence__c
,Apttus_Config2__LineStatus__c
,Apttus_Config2__LineType__c
,Apttus_Config2__ListPrice__c
,SWT_List_Price__c
,Apttus_Config2__LocationId__c
,SWT_Manual_Config_Check__c
,SWT_Manual_Pricing__c
,SWT_Manual_VSOE__c
,Apttus_Config2__MaxPrice__c
,Apttus_Config2__MaxUsageQuantity__c
,Apttus_Config2__MinMaxPriceAppliesTo__c
,Apttus_Config2__MinPrice__c
,Apttus_Config2__MinUsageQuantity__c
,Apttus_Config2__NetAdjustmentPercent__c
,Apttus_Config2__NetPrice__c
,SWT_Net_Price__c
,Apttus_Config2__NetUnitPrice__c
,SWT_Net_Unit_Price__c
,SWT_Non_Discountable_SKU__c
,SWT_Not_For_Resale__c
,SWT_Oppty_Owner_Manager__c
,Apttus_Config2__OptionCost__c
,Apttus_Config2__OptionGroupLabel__c
,Apttus_Config2__OptionPrice__c
,Apttus_Config2__OptionSequence__c
,SWT_Orange_Band_Threshold__c
,SWT_O_Threshold_for_Display__c
,SWT_Overage_Type__c
,Apttus_Config2__ParentBundleNumber__c
,SWT_Partner_Discount_Amount__c
,SWT_Partner_Discount_Percentage__c
,Apttus_Config2__PaymentTermId__c
,Apttus_Config2__RelatedPercent__c
,Apttus_Config2__RelatedPercentAppliesTo__c
,Apttus_Config2__PriceAdjustment__c
,Apttus_Config2__PriceAdjustmentAmount__c
,Apttus_Config2__PriceAdjustmentAppliesTo__c
,Apttus_Config2__PriceAdjustmentType__c
,Apttus_Config2__PriceGroup__c
,Apttus_Config2__PriceIncludedInBundle__c
,Apttus_Config2__PriceListId__c
,Apttus_Config2__PriceMethod__c
,Apttus_Config2__PriceType__c
,Apttus_Config2__PricingDate__c
,Apttus_Config2__Frequency__c
,Apttus_Config2__PricingGuidance__c
,SWT_Pricing_Method__c
,Apttus_Config2__PricingStatus__c
,Apttus_Config2__PricingSteps__c
,Apttus_Config2__Term__c
,Apttus_Config2__PriceUom__c
,Apttus_Config2__PrimaryLineNumber__c
,SWT_Product_Config_Type__c
,SWT_Product_Name_on_Template__c
,SWT_ProductRatePlanChargeID__c
,SWT_Product_Sub_Type__c
,SWT_Product_Type__c
,SWT_Product_Type_Business__c
,SWT_ProductTypeForApprovals__c
,Apttus_Config2__Uom__c
,Apttus_Config2__ProductVersion__c
,SWT_Promotional_Discount_Percentage__c
,SWT_Promotion_Discount_Amount__c
,SWT_PS_Level_2_Queue__c
,Apttus_Config2__Quantity__c
,SWT_Quantity__c
,SWT_Quote__c
,SWT_Quote_Billing_Frequency__c
,SWT_Quote_Sub_Type__c
,SWT_Quote_Type__c
,SWT_Red_Band_Threshold__c
,Apttus_Config2__RelatedAdjustmentAmount__c
,Apttus_Config2__RelatedAdjustmentAppliesTo__c
,Apttus_Config2__RelatedAdjustmentType__c
,SWT_RelatedProduct__c
,SWT_Related_Quantity__c
,Apttus_Config2__RenewalAdjustmentAmount__c
,Apttus_Config2__RenewalAdjustmentType__c
,Apttus_Config2__RollupPriceMethod__c
,Apttus_Config2__RollupPriceToBundle__c
,SWT_R_Threshold_for_Display__c
,Apttus_Config2__SellingFrequency__c
,Apttus_Config2__SellingTerm__c
,SWT_Selling_Term__c
,Apttus_Config2__ShipToAccountId__c
,SWT_Ship_To_Address__c
,SWT_Sold_By_Pack__c
,Apttus_Config2__StartDate__c
,Apttus_Config2__StatusDetails__c
,SWT_Subscription_Asset_Qty__c
,SWT_Support_Error__c
,Support_Term__c
,Apttus_Config2__SyncStatus__c
,Apttus_Config2__Taxable__c
,SWT_Tax_Amount__c
,SWT_Tax_Code__c
,Apttus_Config2__TaxInclusive__c
,SWT_Tax_Rate__c
,SWT_Tax_Type__c
,SWT_Tier_Type_Formula__c
,SWT_Total_Discount_Value__c
,SWT_Total_Discount_Amount__c
,Apttus_Config2__TotalQuantity__c
,Apttus_Config2__UnitCostAdjustment__c
,Apttus_Config2__UnitPriceAdjustmentAuto__c
,Apttus_Config2__UnitPriceAdjustmentManual__c
,SWT_Uom__c
,swt_uom_soldbyquantity__c
,SWT_UnitOfMeasure__c
,SWT_USDListPrice__c
,SWT_USDNetPrice__c
,SWT_VSOE_Approval_Indicator__c
,SWT_VSOE_lower_band__c
,SWT_VSOE_Module__c
,SWT_VSOE_upper_band__c
,SWT_VSOE_Value__c
,SWT_VSOE_Value_Pricing__c
,SWT_Yellow_Band_Threshold__c
,SWT_ZuoraProductRatePlanID__c
,LastModifiedDate
,SWT_Support_Net_Price__c
,SWT_License_Net_Price__c
,SWT_Support_List_Price__c
,SWT_License_List_Price__c
,SWT_Customer_Account_Reference__c
,SWT_Entitlement_Id__c
,SWT_Y_Threshold_for_Display__c
,SWT_Previous_Year_License_Net_Price__c
,SWT_Previous_Year_Support_Net_Price__c
,SWT_Legacy_SAID__c
,SWT_IsListBasePriceZero__c
,SWT_Price_For_Calculation__c
,SWT_Support_Business_Area__c
,SWT_Product_Tax_Code__c
,SWT_Expected_Start_Date__c
,SWT_Program_Discount_Amount__c
,SWT_Program_Discount_Percentage__c
,SWT_Quantity_Reduced__c
,SWT_Is_Quantity_Reduced__c
,SWT_Asset_Product_Code__c
,SWT_Zuora_Rate_Plan_Charge_ID__c
,SWT_Renewal_Status__c
,SWT_Cancellation_Type__c
,SWT_Cancellation_Reason__c
,SWT_Cancellation_Note__c
,SWT_Product_Code__c
,SWT_has_stackable_promotion__c
,SWT_Is_ChannelFulfilled__c
,SWT_Additional_Discount_Threshold__c
,SWT_Approval_Required_Check__c
,SWT_Approval_Required_Purchase_Type__c
,SWT_Approval_Required_Region__c
,SWT_Discount_Threshold_Check__c
,SWT_Manual_Config_Check_Purchase_Type__c
,SWT_Manual_Config_Check_Region__c
,SWT_Manual_Config_Required_Check__c
,SWT_Quote_Region__c
,SWT_Recommended_Quantity__c
,SWT_Initial_Zuora_Rate_Plan_Charge_ID__c
,SWT_SmartDiscount_Link__c
,SWT_SmartDiscount_Match__c
,SWT_New_Line_Item__c
,SWT_Initial_Quantity_New_Business__c
,SWT_Associated_Cancelled_Asset__c
,SWT_Support_Level__c
,SWT_Billing_Plan__c
,SWT_Mass_Update__c
,SWT_Is_Quantity_Extended__c
,SWT_Custom_Asset_Line_Item_ID__c
,SWT_Product_Detail_Code__c
,SWT_UOM_code__c
,SWT_Education_Cancellation_Reason__c
,SWT_Asset_Quantity__c
,SWT_RenewalCurrentListPrice__c
,SWT_Renewal_Adjustment_Percentage__c
,SWT_Renewal_Adjustment_Amount__c
,SWT_Is_Renewed_Migrated__c
,SWT_Expected_Unit_Price_for_Renewals__c
,SWT_Previous_Year_Unit_Net_Price__c
,SWT_Upgrade_TradeIN_SKU__c
,SWT_Upgrade_TradeIn_Price__c
,SWT_Quote_Country__c
,SWT_Renewing_EL_Product__c
,SWT_Initial_Product_before_Migration__c
,SWT_List_Price_Rounded__c
,SWT_No_Run_Education_Pricing__c
,SWT_RenewalAdditionalDiscountPercentage__c
,SWT_RenewalAdditionalAdjustmentType__c
,SWT_RenewalAdditionalDiscount__c
,SWT_migration_type__c
,SWT_Migration_Flag__c
,SWT_Constraint_Rule_Skip__c
,SWT_Is_Product_Renewable__c
,SWT_ELA_Complimentary__c
,SWT_Product_Billing_Plan__c
,SWT_SupportLevelOfProduct__c
,SWT_Charge_Description__c
,SWT_Skip_Constraint_Rules_For_Assets__c
,IsDeleted
,RecordTypeId
,CreatedDate
,SystemModstamp
,LastActivityDate
,SWT_VSOE__c
,SWT_Go_To_Market_Route__c
,SWT_Expected_End_Date__c
,SWT_Skip_Constraint_Rule_Check__c
,SWT_Original_Quantity__c
,Apttus_Config2__CollaborationParentLineNumber__c
,Apttus_Config2__IsOptional__c
,SWT_Zuora_Subscription_Rate_Plan_ID__c
,SWT_Appliance_Serial_Number__c
,SWT_Discount_Level__c
,SWT_CartExtendedListPrice__c
,SWT_RenewalAdditionalDiscountPercentVal__c
,SWT_Line_Type__c
,SWT_Control_Tower_ID__c
,SWT_Termination_Quantity__c
,SWT_InitialBillingFrequency__c
,SYSDATE AS LD_DT
,SWT_INS_DT
,'base'
FROM "swt_rpt_base".AT_Apttus_Config2__LineItem__c WHERE id in
(SELECT STG.id FROM AT_Apttus_Config2__LineItem__c_stg_Tmp_Key STG JOIN AT_Apttus_Config2__LineItem__c_base_Tmp
ON STG.id = AT_Apttus_Config2__LineItem__c_base_Tmp.id AND STG.LastModifiedDate >= AT_Apttus_Config2__LineItem__c_base_Tmp.LastModifiedDate);



/* Deleting before seven days data from current date in the Historical Table */  

/*delete /*+DIRECT*/ from "swt_rpt_stg"."AT_Apttus_Config2__LineItem__c_HIST"  where LD_DT::date <= TIMESTAMPADD(DAY,-7,sysdate)::date; */


 /* Incremental VSQL script for loading data from Stage to Base */  

DELETE /*+DIRECT*/ FROM "swt_rpt_base".AT_Apttus_Config2__LineItem__c WHERE id in
(SELECT STG.id FROM AT_Apttus_Config2__LineItem__c_stg_Tmp_Key STG JOIN AT_Apttus_Config2__LineItem__c_base_Tmp
ON STG.id = AT_Apttus_Config2__LineItem__c_base_Tmp.id AND STG.LastModifiedDate >= AT_Apttus_Config2__LineItem__c_base_Tmp.LastModifiedDate);


INSERT /*+DIRECT*/ INTO "swt_rpt_base".AT_Apttus_Config2__LineItem__c
(
Id
,Apttus_Config2__AssetId__c
,Apttus_Config2__AssetLineItemId__c
,SWT_Asset_Line_Item__c
,Apttus_Config2__AttributeValueId__c
,Apttus_Config2__BaseProductId__c
,Apttus_Config2__ClassificationId__c
,Apttus_Config2__ChargeGroupId__c
,Apttus_Config2__CollaborationRequestId__c
,Apttus_Config2__ConfigurationId__c
,Apttus_Config2__DerivedFromId__c
,SWT_Education_Approval_Check_1__c
,Apttus_Config2__IncentiveId__c
,SWT_Is_Premier_Support__c
,Is_VSOE_Less_And_Support__c
,SWT_Is_VSOE_less_than_lower_band__c
,SWT_License_Discount_90__c
,Apttus_Config2__OptionId__c
,SWT_OrangeThresholdCheck__c
,SWT_OrangeThresholdCheckForSupport__c
,SWT_ParentLineItem__c
,SWT_Percentage_of_License_Net__c
,Apttus_Config2__PriceListItemId__c
,Apttus_Config2__ProductId__c
,Apttus_Config2__ProductOptionId__c
,SWT_Promotion__c
,SWT_PS_Level_2_Approval_Check__c
,SWT_PS_Level_3_Approval_Check__c
,SWT_RedThresholdCheck__c
,SWT_RedThresholdCheckForSupport__c
,RedThresholdCheckL3__c
,RedThresholdCheckL4__c
,SWT_SAAS_Approvals_Check__c
,SWT_Saas_L2_Approvals_Check__c
,SAAS_L4_BU_GM_Approval__c
,Apttus_Config2__ServiceLocationId__c
,Apttus_Config2__SummaryGroupId__c
,Apttus_Config2__TaxCodeId__c
,SWT_Term_Range__c
,SWT_Total_Discount_Percentage__c
,Apttus_Config2__AdHocGroupId__c
,Apttus_Config2__TransferPriceLineItemId__c
,SW_UpfrontBilling__c
,SWT_YellowThresholdCheck__c
,SWT_YellowThresholdCheckForSupport__c
,Apttus_Config2__RelatedItemId__c
,CreatedById
,CurrencyIsoCode
,LastModifiedbyId
,Name
,Apttus_Config2__AddedBy__c
,Apttus_Config2__AddedByRuleInfo__c
,SWT_Additional_Adjustment_Type__c
,SWT_Additional_Discount__c
,SWT_Additional_Discount_Percentage__c
,Apttus_Config2__AdjustedPrice__c
,Apttus_Config2__AdjustmentAmount__c
,Apttus_Config2__AdjustmentType__c
,SWT_Advanced_Support_Resource__c
,Agreement_Bypass__c
,Apttus_Config2__AllocateGroupAdjustment__c
,Apttus_Config2__AllowableAction__c
,Apttus_Config2__AllowManualAdjustment__c
,Apttus_Config2__AllowProration__c
,Apttus_Config2__AllowRemoval__c
,SWT_Approval_Required__c
,Apttus_CQApprov__Approval_Status__c
,SWT_Asset_Line_Item_ID__c
,SWT_Asset_LI_Quantity_Check__c
,Apttus_Config2__AssetQuantity__c
,SWT_Authority_Currency_Code__c
,Apttus_Config2__AutoRenew__c
,Apttus_Config2__AutoRenewalTerm__c
,Apttus_Config2__AutoRenewalType__c
,Apttus_Config2__BaseCost__c
,Apttus_Config2__BaseCostOverride__c
,Apttus_Config2__BaseExtendedCost__c
,Apttus_Config2__BaseExtendedPrice__c
,Apttus_Config2__BasePrice__c
,Apttus_Config2__BasePriceOverride__c
,Apttus_Config2__BasePriceMethod__c
,Apttus_Config2__BillingFrequency__c
,Apttus_Config2__BillingPreferenceId__c
,Apttus_Config2__BillingRule__c
,Apttus_Config2__BillToAccountId__c
,SWT_Business_Area__c
,SWT_Cart_Total_License_List_Price__c
,SWT_Cascade_Support_Discount__c
,Apttus_Config2__ClassificationHierarchy__c
,Apttus_Config2__ClassificationHierarchyInfo__c
,SWT_Channel_CMT_MD_Lead_Queue__c
,SWT_Channel_Manager_Queue__c
,Apttus_Config2__ChargeType__c
,SWT_CMT_MD_Lead_Queue__c
,Apttus_Config2__Comments__c
,Apttus_Config2__CommitmentQuantity__c
,Apttus_Config2__ConfigStatus__c
,Apttus_Config2__ConstraintCheckStatus__c
,Apttus_Config2__ContractNumbers__c
,SWT_Contractual_Discount_Amount__c
,SWT_Contractual_Discount_Percentage__c
,Apttus_Config2__CopySourceBundleNumber__c
,Apttus_Config2__CopySourceLineNumber__c
,Apttus_Config2__CopySourceNumber__c
,Apttus_Config2__Cost__c
,Apttus_Config2__CouponCode__c
,SWT_CSR_Approvals__c
,SWT_CSR_Compensation__c
,SWT_CSR_Routed__c
,Apttus_Config2__Customizable__c
,SWT_Deal_Desk__c
,Apttus_Config2__DeltaPrice__c
,Apttus_Config2__DeltaQuantity__c
,Apttus_Config2__Description__c
,SWT_Discounting_Band__c
,SWT_Discounting_Threshold__c
,Apttus_Config2__EndDate__c
,Apttus_Config2__ExtendedCost__c
,Apttus_Config2__ExtendedDescription__c
,SWT_Extended_List_Price__c
,Apttus_Config2__ExtendedPrice__c
,Apttus_Config2__ExtendedQuantity__c
,SWT_First_Line_Manager_Queue__c
,Apttus_Config2__FlatOptionPrice__c
,Apttus_Config2__GroupAdjustmentPercent__c
,Apttus_Config2__Guidance__c
,Apttus_Config2__HasAttributes__c
,Apttus_Config2__HasBaseProduct__c
,Apttus_Config2__HasDefaults__c
,Apttus_Config2__HasIncentives__c
,Apttus_Config2__HasOptions__c
,Apttus_Config2__HasTieredPrice__c
,Apttus_Config2__HideCopyAction__c
,Apttus_Config2__HideInvoiceDisplay__c
,SWT_HPE_Grace_Period__c
,SWT_HPE_RampUp__c
,Apttus_Config2__IncentiveAdjustmentAmount__c
,Apttus_Config2__IncentiveBasePrice__c
,Apttus_Config2__IncentiveCode__c
,Apttus_Config2__IncentiveExtendedPrice__c
,Apttus_Config2__IncentiveType__c
,Apttus_Config2__IsAssetPricing__c
,SWT_Is_Complex_Promotion_Applied__c
,Apttus_Config2__IsCustomPricing__c
,Apttus_Config2__IsHidden__c
,Apttus_Config2__IsOptionRollupLine__c
,Apttus_Config2__IsPrimaryLine__c
,Apttus_Config2__IsPrimaryRampLine__c
,Apttus_Config2__IsQuantityModifiable__c
,Apttus_Config2__IsReadOnly__c
,Apttus_Config2__IsSellingTermReadOnly__c
,Apttus_Config2__IsUsageTierModifiable__c
,Apttus_Config2__ItemSequence__c
,SWT_Jurisdiction_Text__c
,SWT_Level_1_Approver__c
,SWT_Level_2_Approver__c
,SWT_Level_3_Approver__c
,SWT_Level_4_Approver__c
,SWT_Level_5_Approver__c
,SWT_Level_6_Approver__c
,SWT_LineItem_Update__c
,Apttus_Config2__LineNumber__c
,Apttus_Config2__LineSequence__c
,Apttus_Config2__LineStatus__c
,Apttus_Config2__LineType__c
,Apttus_Config2__ListPrice__c
,SWT_List_Price__c
,Apttus_Config2__LocationId__c
,SWT_Manual_Config_Check__c
,SWT_Manual_Pricing__c
,SWT_Manual_VSOE__c
,Apttus_Config2__MaxPrice__c
,Apttus_Config2__MaxUsageQuantity__c
,Apttus_Config2__MinMaxPriceAppliesTo__c
,Apttus_Config2__MinPrice__c
,Apttus_Config2__MinUsageQuantity__c
,Apttus_Config2__NetAdjustmentPercent__c
,Apttus_Config2__NetPrice__c
,SWT_Net_Price__c
,Apttus_Config2__NetUnitPrice__c
,SWT_Net_Unit_Price__c
,SWT_Non_Discountable_SKU__c
,SWT_Not_For_Resale__c
,SWT_Oppty_Owner_Manager__c
,Apttus_Config2__OptionCost__c
,Apttus_Config2__OptionGroupLabel__c
,Apttus_Config2__OptionPrice__c
,Apttus_Config2__OptionSequence__c
,SWT_Orange_Band_Threshold__c
,SWT_O_Threshold_for_Display__c
,SWT_Overage_Type__c
,Apttus_Config2__ParentBundleNumber__c
,SWT_Partner_Discount_Amount__c
,SWT_Partner_Discount_Percentage__c
,Apttus_Config2__PaymentTermId__c
,Apttus_Config2__RelatedPercent__c
,Apttus_Config2__RelatedPercentAppliesTo__c
,Apttus_Config2__PriceAdjustment__c
,Apttus_Config2__PriceAdjustmentAmount__c
,Apttus_Config2__PriceAdjustmentAppliesTo__c
,Apttus_Config2__PriceAdjustmentType__c
,Apttus_Config2__PriceGroup__c
,Apttus_Config2__PriceIncludedInBundle__c
,Apttus_Config2__PriceListId__c
,Apttus_Config2__PriceMethod__c
,Apttus_Config2__PriceType__c
,Apttus_Config2__PricingDate__c
,Apttus_Config2__Frequency__c
,Apttus_Config2__PricingGuidance__c
,SWT_Pricing_Method__c
,Apttus_Config2__PricingStatus__c
,Apttus_Config2__PricingSteps__c
,Apttus_Config2__Term__c
,Apttus_Config2__PriceUom__c
,Apttus_Config2__PrimaryLineNumber__c
,SWT_Product_Config_Type__c
,SWT_Product_Name_on_Template__c
,SWT_ProductRatePlanChargeID__c
,SWT_Product_Sub_Type__c
,SWT_Product_Type__c
,SWT_Product_Type_Business__c
,SWT_ProductTypeForApprovals__c
,Apttus_Config2__Uom__c
,Apttus_Config2__ProductVersion__c
,SWT_Promotional_Discount_Percentage__c
,SWT_Promotion_Discount_Amount__c
,SWT_PS_Level_2_Queue__c
,Apttus_Config2__Quantity__c
,SWT_Quantity__c
,SWT_Quote__c
,SWT_Quote_Billing_Frequency__c
,SWT_Quote_Sub_Type__c
,SWT_Quote_Type__c
,SWT_Red_Band_Threshold__c
,Apttus_Config2__RelatedAdjustmentAmount__c
,Apttus_Config2__RelatedAdjustmentAppliesTo__c
,Apttus_Config2__RelatedAdjustmentType__c
,SWT_RelatedProduct__c
,SWT_Related_Quantity__c
,Apttus_Config2__RenewalAdjustmentAmount__c
,Apttus_Config2__RenewalAdjustmentType__c
,Apttus_Config2__RollupPriceMethod__c
,Apttus_Config2__RollupPriceToBundle__c
,SWT_R_Threshold_for_Display__c
,Apttus_Config2__SellingFrequency__c
,Apttus_Config2__SellingTerm__c
,SWT_Selling_Term__c
,Apttus_Config2__ShipToAccountId__c
,SWT_Ship_To_Address__c
,SWT_Sold_By_Pack__c
,Apttus_Config2__StartDate__c
,Apttus_Config2__StatusDetails__c
,SWT_Subscription_Asset_Qty__c
,SWT_Support_Error__c
,Support_Term__c
,Apttus_Config2__SyncStatus__c
,Apttus_Config2__Taxable__c
,SWT_Tax_Amount__c
,SWT_Tax_Code__c
,Apttus_Config2__TaxInclusive__c
,SWT_Tax_Rate__c
,SWT_Tax_Type__c
,SWT_Tier_Type_Formula__c
,SWT_Total_Discount_Value__c
,SWT_Total_Discount_Amount__c
,Apttus_Config2__TotalQuantity__c
,Apttus_Config2__UnitCostAdjustment__c
,Apttus_Config2__UnitPriceAdjustmentAuto__c
,Apttus_Config2__UnitPriceAdjustmentManual__c
,SWT_Uom__c
,swt_uom_soldbyquantity__c
,SWT_UnitOfMeasure__c
,SWT_USDListPrice__c
,SWT_USDNetPrice__c
,SWT_VSOE_Approval_Indicator__c
,SWT_VSOE_lower_band__c
,SWT_VSOE_Module__c
,SWT_VSOE_upper_band__c
,SWT_VSOE_Value__c
,SWT_VSOE_Value_Pricing__c
,SWT_Yellow_Band_Threshold__c
,SWT_ZuoraProductRatePlanID__c
,LastModifiedDate
,SWT_Support_Net_Price__c
,SWT_License_Net_Price__c
,SWT_Support_List_Price__c
,SWT_License_List_Price__c
,SWT_Customer_Account_Reference__c
,SWT_Entitlement_Id__c
,SWT_Y_Threshold_for_Display__c
,SWT_Previous_Year_License_Net_Price__c
,SWT_Previous_Year_Support_Net_Price__c
,SWT_Legacy_SAID__c
,SWT_IsListBasePriceZero__c
,SWT_Price_For_Calculation__c
,SWT_Support_Business_Area__c
,SWT_Product_Tax_Code__c
,SWT_Expected_Start_Date__c
,SWT_Program_Discount_Amount__c
,SWT_Program_Discount_Percentage__c
,SWT_Quantity_Reduced__c
,SWT_Is_Quantity_Reduced__c
,SWT_Asset_Product_Code__c
,SWT_Zuora_Rate_Plan_Charge_ID__c
,SWT_Renewal_Status__c
,SWT_Cancellation_Type__c
,SWT_Cancellation_Reason__c
,SWT_Cancellation_Note__c
,SWT_Product_Code__c
,SWT_has_stackable_promotion__c
,SWT_Is_ChannelFulfilled__c
,SWT_Additional_Discount_Threshold__c
,SWT_Approval_Required_Check__c
,SWT_Approval_Required_Purchase_Type__c
,SWT_Approval_Required_Region__c
,SWT_Discount_Threshold_Check__c
,SWT_Manual_Config_Check_Purchase_Type__c
,SWT_Manual_Config_Check_Region__c
,SWT_Manual_Config_Required_Check__c
,SWT_Quote_Region__c
,SWT_Recommended_Quantity__c
,SWT_Initial_Zuora_Rate_Plan_Charge_ID__c
,SWT_SmartDiscount_Link__c
,SWT_SmartDiscount_Match__c
,SWT_New_Line_Item__c
,SWT_Initial_Quantity_New_Business__c
,SWT_Associated_Cancelled_Asset__c
,SWT_Support_Level__c
,SWT_Billing_Plan__c
,SWT_Mass_Update__c
,SWT_Is_Quantity_Extended__c
,SWT_Custom_Asset_Line_Item_ID__c
,SWT_Product_Detail_Code__c
,SWT_UOM_code__c
,SWT_Education_Cancellation_Reason__c
,SWT_Asset_Quantity__c
,SWT_RenewalCurrentListPrice__c
,SWT_Renewal_Adjustment_Percentage__c
,SWT_Renewal_Adjustment_Amount__c
,SWT_Is_Renewed_Migrated__c
,SWT_Expected_Unit_Price_for_Renewals__c
,SWT_Previous_Year_Unit_Net_Price__c
,SWT_Upgrade_TradeIN_SKU__c
,SWT_Upgrade_TradeIn_Price__c
,SWT_Quote_Country__c
,SWT_Renewing_EL_Product__c
,SWT_Initial_Product_before_Migration__c
,SWT_List_Price_Rounded__c
,SWT_No_Run_Education_Pricing__c
,SWT_RenewalAdditionalDiscountPercentage__c
,SWT_RenewalAdditionalAdjustmentType__c
,SWT_RenewalAdditionalDiscount__c
,SWT_migration_type__c
,SWT_Migration_Flag__c
,SWT_Constraint_Rule_Skip__c
,SWT_Is_Product_Renewable__c
,SWT_ELA_Complimentary__c
,SWT_Product_Billing_Plan__c
,SWT_SupportLevelOfProduct__c
,SWT_Charge_Description__c
,SWT_Skip_Constraint_Rules_For_Assets__c
,IsDeleted
,RecordTypeId
,CreatedDate
,SystemModstamp
,LastActivityDate
,SWT_VSOE__c
,SWT_Go_To_Market_Route__c
,SWT_Expected_End_Date__c
,SWT_Skip_Constraint_Rule_Check__c
,SWT_Original_Quantity__c
,Apttus_Config2__CollaborationParentLineNumber__c
,Apttus_Config2__IsOptional__c
,SWT_Zuora_Subscription_Rate_Plan_ID__c
,SWT_Appliance_Serial_Number__c
,SWT_Discount_Level__c
,SWT_CartExtendedListPrice__c
,SWT_RenewalAdditionalDiscountPercentVal__c
,SWT_Line_Type__c
,SWT_Control_Tower_ID__c
,SWT_Termination_Quantity__c
,SWT_InitialBillingFrequency__c
,SWT_INS_DT
)
SELECT DISTINCT 
AT_Apttus_Config2__LineItem__c_stg_Tmp.Id
,Apttus_Config2__AssetId__c
,Apttus_Config2__AssetLineItemId__c
,SWT_Asset_Line_Item__c
,Apttus_Config2__AttributeValueId__c
,Apttus_Config2__BaseProductId__c
,Apttus_Config2__ClassificationId__c
,Apttus_Config2__ChargeGroupId__c
,Apttus_Config2__CollaborationRequestId__c
,Apttus_Config2__ConfigurationId__c
,Apttus_Config2__DerivedFromId__c
,SWT_Education_Approval_Check_1__c
,Apttus_Config2__IncentiveId__c
,SWT_Is_Premier_Support__c
,Is_VSOE_Less_And_Support__c
,SWT_Is_VSOE_less_than_lower_band__c
,SWT_License_Discount_90__c
,Apttus_Config2__OptionId__c
,SWT_OrangeThresholdCheck__c
,SWT_OrangeThresholdCheckForSupport__c
,SWT_ParentLineItem__c
,SWT_Percentage_of_License_Net__c
,Apttus_Config2__PriceListItemId__c
,Apttus_Config2__ProductId__c
,Apttus_Config2__ProductOptionId__c
,SWT_Promotion__c
,SWT_PS_Level_2_Approval_Check__c
,SWT_PS_Level_3_Approval_Check__c
,SWT_RedThresholdCheck__c
,SWT_RedThresholdCheckForSupport__c
,RedThresholdCheckL3__c
,RedThresholdCheckL4__c
,SWT_SAAS_Approvals_Check__c
,SWT_Saas_L2_Approvals_Check__c
,SAAS_L4_BU_GM_Approval__c
,Apttus_Config2__ServiceLocationId__c
,Apttus_Config2__SummaryGroupId__c
,Apttus_Config2__TaxCodeId__c
,SWT_Term_Range__c
,SWT_Total_Discount_Percentage__c
,Apttus_Config2__AdHocGroupId__c
,Apttus_Config2__TransferPriceLineItemId__c
,SW_UpfrontBilling__c
,SWT_YellowThresholdCheck__c
,SWT_YellowThresholdCheckForSupport__c
,Apttus_Config2__RelatedItemId__c
,CreatedById
,CurrencyIsoCode
,LastModifiedbyId
,Name
,Apttus_Config2__AddedBy__c
,Apttus_Config2__AddedByRuleInfo__c
,SWT_Additional_Adjustment_Type__c
,SWT_Additional_Discount__c
,SWT_Additional_Discount_Percentage__c
,Apttus_Config2__AdjustedPrice__c
,Apttus_Config2__AdjustmentAmount__c
,Apttus_Config2__AdjustmentType__c
,SWT_Advanced_Support_Resource__c
,Agreement_Bypass__c
,Apttus_Config2__AllocateGroupAdjustment__c
,Apttus_Config2__AllowableAction__c
,Apttus_Config2__AllowManualAdjustment__c
,Apttus_Config2__AllowProration__c
,Apttus_Config2__AllowRemoval__c
,SWT_Approval_Required__c
,Apttus_CQApprov__Approval_Status__c
,SWT_Asset_Line_Item_ID__c
,SWT_Asset_LI_Quantity_Check__c
,Apttus_Config2__AssetQuantity__c
,SWT_Authority_Currency_Code__c
,Apttus_Config2__AutoRenew__c
,Apttus_Config2__AutoRenewalTerm__c
,Apttus_Config2__AutoRenewalType__c
,Apttus_Config2__BaseCost__c
,Apttus_Config2__BaseCostOverride__c
,Apttus_Config2__BaseExtendedCost__c
,Apttus_Config2__BaseExtendedPrice__c
,Apttus_Config2__BasePrice__c
,Apttus_Config2__BasePriceOverride__c
,Apttus_Config2__BasePriceMethod__c
,Apttus_Config2__BillingFrequency__c
,Apttus_Config2__BillingPreferenceId__c
,Apttus_Config2__BillingRule__c
,Apttus_Config2__BillToAccountId__c
,SWT_Business_Area__c
,SWT_Cart_Total_License_List_Price__c
,SWT_Cascade_Support_Discount__c
,Apttus_Config2__ClassificationHierarchy__c
,Apttus_Config2__ClassificationHierarchyInfo__c
,SWT_Channel_CMT_MD_Lead_Queue__c
,SWT_Channel_Manager_Queue__c
,Apttus_Config2__ChargeType__c
,SWT_CMT_MD_Lead_Queue__c
,Apttus_Config2__Comments__c
,Apttus_Config2__CommitmentQuantity__c
,Apttus_Config2__ConfigStatus__c
,Apttus_Config2__ConstraintCheckStatus__c
,Apttus_Config2__ContractNumbers__c
,SWT_Contractual_Discount_Amount__c
,SWT_Contractual_Discount_Percentage__c
,Apttus_Config2__CopySourceBundleNumber__c
,Apttus_Config2__CopySourceLineNumber__c
,Apttus_Config2__CopySourceNumber__c
,Apttus_Config2__Cost__c
,Apttus_Config2__CouponCode__c
,SWT_CSR_Approvals__c
,SWT_CSR_Compensation__c
,SWT_CSR_Routed__c
,Apttus_Config2__Customizable__c
,SWT_Deal_Desk__c
,Apttus_Config2__DeltaPrice__c
,Apttus_Config2__DeltaQuantity__c
,Apttus_Config2__Description__c
,SWT_Discounting_Band__c
,SWT_Discounting_Threshold__c
,Apttus_Config2__EndDate__c
,Apttus_Config2__ExtendedCost__c
,Apttus_Config2__ExtendedDescription__c
,SWT_Extended_List_Price__c
,Apttus_Config2__ExtendedPrice__c
,Apttus_Config2__ExtendedQuantity__c
,SWT_First_Line_Manager_Queue__c
,Apttus_Config2__FlatOptionPrice__c
,Apttus_Config2__GroupAdjustmentPercent__c
,Apttus_Config2__Guidance__c
,Apttus_Config2__HasAttributes__c
,Apttus_Config2__HasBaseProduct__c
,Apttus_Config2__HasDefaults__c
,Apttus_Config2__HasIncentives__c
,Apttus_Config2__HasOptions__c
,Apttus_Config2__HasTieredPrice__c
,Apttus_Config2__HideCopyAction__c
,Apttus_Config2__HideInvoiceDisplay__c
,SWT_HPE_Grace_Period__c
,SWT_HPE_RampUp__c
,Apttus_Config2__IncentiveAdjustmentAmount__c
,Apttus_Config2__IncentiveBasePrice__c
,Apttus_Config2__IncentiveCode__c
,Apttus_Config2__IncentiveExtendedPrice__c
,Apttus_Config2__IncentiveType__c
,Apttus_Config2__IsAssetPricing__c
,SWT_Is_Complex_Promotion_Applied__c
,Apttus_Config2__IsCustomPricing__c
,Apttus_Config2__IsHidden__c
,Apttus_Config2__IsOptionRollupLine__c
,Apttus_Config2__IsPrimaryLine__c
,Apttus_Config2__IsPrimaryRampLine__c
,Apttus_Config2__IsQuantityModifiable__c
,Apttus_Config2__IsReadOnly__c
,Apttus_Config2__IsSellingTermReadOnly__c
,Apttus_Config2__IsUsageTierModifiable__c
,Apttus_Config2__ItemSequence__c
,SWT_Jurisdiction_Text__c
,SWT_Level_1_Approver__c
,SWT_Level_2_Approver__c
,SWT_Level_3_Approver__c
,SWT_Level_4_Approver__c
,SWT_Level_5_Approver__c
,SWT_Level_6_Approver__c
,SWT_LineItem_Update__c
,Apttus_Config2__LineNumber__c
,Apttus_Config2__LineSequence__c
,Apttus_Config2__LineStatus__c
,Apttus_Config2__LineType__c
,Apttus_Config2__ListPrice__c
,SWT_List_Price__c
,Apttus_Config2__LocationId__c
,SWT_Manual_Config_Check__c
,SWT_Manual_Pricing__c
,SWT_Manual_VSOE__c
,Apttus_Config2__MaxPrice__c
,Apttus_Config2__MaxUsageQuantity__c
,Apttus_Config2__MinMaxPriceAppliesTo__c
,Apttus_Config2__MinPrice__c
,Apttus_Config2__MinUsageQuantity__c
,Apttus_Config2__NetAdjustmentPercent__c
,Apttus_Config2__NetPrice__c
,SWT_Net_Price__c
,Apttus_Config2__NetUnitPrice__c
,SWT_Net_Unit_Price__c
,SWT_Non_Discountable_SKU__c
,SWT_Not_For_Resale__c
,SWT_Oppty_Owner_Manager__c
,Apttus_Config2__OptionCost__c
,Apttus_Config2__OptionGroupLabel__c
,Apttus_Config2__OptionPrice__c
,Apttus_Config2__OptionSequence__c
,SWT_Orange_Band_Threshold__c
,SWT_O_Threshold_for_Display__c
,SWT_Overage_Type__c
,Apttus_Config2__ParentBundleNumber__c
,SWT_Partner_Discount_Amount__c
,SWT_Partner_Discount_Percentage__c
,Apttus_Config2__PaymentTermId__c
,Apttus_Config2__RelatedPercent__c
,Apttus_Config2__RelatedPercentAppliesTo__c
,Apttus_Config2__PriceAdjustment__c
,Apttus_Config2__PriceAdjustmentAmount__c
,Apttus_Config2__PriceAdjustmentAppliesTo__c
,Apttus_Config2__PriceAdjustmentType__c
,Apttus_Config2__PriceGroup__c
,Apttus_Config2__PriceIncludedInBundle__c
,Apttus_Config2__PriceListId__c
,Apttus_Config2__PriceMethod__c
,Apttus_Config2__PriceType__c
,Apttus_Config2__PricingDate__c
,Apttus_Config2__Frequency__c
,Apttus_Config2__PricingGuidance__c
,SWT_Pricing_Method__c
,Apttus_Config2__PricingStatus__c
,Apttus_Config2__PricingSteps__c
,Apttus_Config2__Term__c
,Apttus_Config2__PriceUom__c
,Apttus_Config2__PrimaryLineNumber__c
,SWT_Product_Config_Type__c
,SWT_Product_Name_on_Template__c
,SWT_ProductRatePlanChargeID__c
,SWT_Product_Sub_Type__c
,SWT_Product_Type__c
,SWT_Product_Type_Business__c
,SWT_ProductTypeForApprovals__c
,Apttus_Config2__Uom__c
,Apttus_Config2__ProductVersion__c
,SWT_Promotional_Discount_Percentage__c
,SWT_Promotion_Discount_Amount__c
,SWT_PS_Level_2_Queue__c
,Apttus_Config2__Quantity__c
,SWT_Quantity__c
,SWT_Quote__c
,SWT_Quote_Billing_Frequency__c
,SWT_Quote_Sub_Type__c
,SWT_Quote_Type__c
,SWT_Red_Band_Threshold__c
,Apttus_Config2__RelatedAdjustmentAmount__c
,Apttus_Config2__RelatedAdjustmentAppliesTo__c
,Apttus_Config2__RelatedAdjustmentType__c
,SWT_RelatedProduct__c
,SWT_Related_Quantity__c
,Apttus_Config2__RenewalAdjustmentAmount__c
,Apttus_Config2__RenewalAdjustmentType__c
,Apttus_Config2__RollupPriceMethod__c
,Apttus_Config2__RollupPriceToBundle__c
,SWT_R_Threshold_for_Display__c
,Apttus_Config2__SellingFrequency__c
,Apttus_Config2__SellingTerm__c
,SWT_Selling_Term__c
,Apttus_Config2__ShipToAccountId__c
,SWT_Ship_To_Address__c
,SWT_Sold_By_Pack__c
,Apttus_Config2__StartDate__c
,Apttus_Config2__StatusDetails__c
,SWT_Subscription_Asset_Qty__c
,SWT_Support_Error__c
,Support_Term__c
,Apttus_Config2__SyncStatus__c
,Apttus_Config2__Taxable__c
,SWT_Tax_Amount__c
,SWT_Tax_Code__c
,Apttus_Config2__TaxInclusive__c
,SWT_Tax_Rate__c
,SWT_Tax_Type__c
,SWT_Tier_Type_Formula__c
,SWT_Total_Discount_Value__c
,SWT_Total_Discount_Amount__c
,Apttus_Config2__TotalQuantity__c
,Apttus_Config2__UnitCostAdjustment__c
,Apttus_Config2__UnitPriceAdjustmentAuto__c
,Apttus_Config2__UnitPriceAdjustmentManual__c
,SWT_Uom__c
,swt_uom_soldbyquantity__c
,SWT_UnitOfMeasure__c
,SWT_USDListPrice__c
,SWT_USDNetPrice__c
,SWT_VSOE_Approval_Indicator__c
,SWT_VSOE_lower_band__c
,SWT_VSOE_Module__c
,SWT_VSOE_upper_band__c
,SWT_VSOE_Value__c
,SWT_VSOE_Value_Pricing__c
,SWT_Yellow_Band_Threshold__c
,SWT_ZuoraProductRatePlanID__c
,AT_Apttus_Config2__LineItem__c_stg_Tmp.LastModifiedDate
,SWT_Support_Net_Price__c
,SWT_License_Net_Price__c
,SWT_Support_List_Price__c
,SWT_License_List_Price__c
,SWT_Customer_Account_Reference__c
,SWT_Entitlement_Id__c
,SWT_Y_Threshold_for_Display__c
,SWT_Previous_Year_License_Net_Price__c
,SWT_Previous_Year_Support_Net_Price__c
,SWT_Legacy_SAID__c
,SWT_IsListBasePriceZero__c
,SWT_Price_For_Calculation__c
,SWT_Support_Business_Area__c
,SWT_Product_Tax_Code__c
,SWT_Expected_Start_Date__c
,SWT_Program_Discount_Amount__c
,SWT_Program_Discount_Percentage__c
,SWT_Quantity_Reduced__c
,SWT_Is_Quantity_Reduced__c
,SWT_Asset_Product_Code__c
,SWT_Zuora_Rate_Plan_Charge_ID__c
,SWT_Renewal_Status__c
,SWT_Cancellation_Type__c
,SWT_Cancellation_Reason__c
,SWT_Cancellation_Note__c
,SWT_Product_Code__c
,SWT_has_stackable_promotion__c
,SWT_Is_ChannelFulfilled__c
,SWT_Additional_Discount_Threshold__c
,SWT_Approval_Required_Check__c
,SWT_Approval_Required_Purchase_Type__c
,SWT_Approval_Required_Region__c
,SWT_Discount_Threshold_Check__c
,SWT_Manual_Config_Check_Purchase_Type__c
,SWT_Manual_Config_Check_Region__c
,SWT_Manual_Config_Required_Check__c
,SWT_Quote_Region__c
,SWT_Recommended_Quantity__c
,SWT_Initial_Zuora_Rate_Plan_Charge_ID__c
,SWT_SmartDiscount_Link__c
,SWT_SmartDiscount_Match__c
,SWT_New_Line_Item__c
,SWT_Initial_Quantity_New_Business__c
,SWT_Associated_Cancelled_Asset__c
,SWT_Support_Level__c
,SWT_Billing_Plan__c
,SWT_Mass_Update__c
,SWT_Is_Quantity_Extended__c
,SWT_Custom_Asset_Line_Item_ID__c
,SWT_Product_Detail_Code__c
,SWT_UOM_code__c
,SWT_Education_Cancellation_Reason__c
,SWT_Asset_Quantity__c
,SWT_RenewalCurrentListPrice__c
,SWT_Renewal_Adjustment_Percentage__c
,SWT_Renewal_Adjustment_Amount__c
,SWT_Is_Renewed_Migrated__c
,SWT_Expected_Unit_Price_for_Renewals__c
,SWT_Previous_Year_Unit_Net_Price__c
,SWT_Upgrade_TradeIN_SKU__c
,SWT_Upgrade_TradeIn_Price__c
,SWT_Quote_Country__c
,SWT_Renewing_EL_Product__c
,SWT_Initial_Product_before_Migration__c
,SWT_List_Price_Rounded__c
,SWT_No_Run_Education_Pricing__c
,SWT_RenewalAdditionalDiscountPercentage__c
,SWT_RenewalAdditionalAdjustmentType__c
,SWT_RenewalAdditionalDiscount__c
,SWT_migration_type__c
,SWT_Migration_Flag__c
,SWT_Constraint_Rule_Skip__c
,SWT_Is_Product_Renewable__c
,SWT_ELA_Complimentary__c
,SWT_Product_Billing_Plan__c
,SWT_SupportLevelOfProduct__c
,SWT_Charge_Description__c
,SWT_Skip_Constraint_Rules_For_Assets__c
,IsDeleted
,RecordTypeId
,CreatedDate
,SystemModstamp
,LastActivityDate
,SWT_VSOE__c
,SWT_Go_To_Market_Route__c
,SWT_Expected_End_Date__c
,SWT_Skip_Constraint_Rule_Check__c
,SWT_Original_Quantity__c
,Apttus_Config2__CollaborationParentLineNumber__c
,Apttus_Config2__IsOptional__c
,SWT_Zuora_Subscription_Rate_Plan_ID__c
,SWT_Appliance_Serial_Number__c
,SWT_Discount_Level__c
,SWT_CartExtendedListPrice__c
,SWT_RenewalAdditionalDiscountPercentVal__c
,SWT_Line_Type__c
,SWT_Control_Tower_ID__c
,SWT_Termination_Quantity__c
,SWT_InitialBillingFrequency__c
,SYSDATE AS SWT_INS_DT
FROM AT_Apttus_Config2__LineItem__c_stg_Tmp JOIN AT_Apttus_Config2__LineItem__c_stg_Tmp_Key ON AT_Apttus_Config2__LineItem__c_stg_Tmp.id=AT_Apttus_Config2__LineItem__c_stg_Tmp_Key.id AND AT_Apttus_Config2__LineItem__c_stg_Tmp.LastModifiedDate=AT_Apttus_Config2__LineItem__c_stg_Tmp_Key.LastModifiedDate
WHERE NOT EXISTS
(SELECT 1 FROM "swt_rpt_base".AT_Apttus_Config2__LineItem__c BASE
WHERE AT_Apttus_Config2__LineItem__c_stg_Tmp.id = BASE.id);

commit;		
		
/* Inserting new audit entry with all stats */

INSERT INTO swt_rpt_stg.FAST_LD_AUDT
(
SUBJECT_AREA
,TBL_NM
,LD_DT
,START_DT_TIME
,END_DT_TIME
,SRC_REC_CNT
,TGT_REC_CNT
,COMPLTN_STAT
)
select 'APTTUS','AT_Apttus_Config2__LineItem__c',sysdate::date,(select st from Start_Time_Tmp),sysdate,(select count from Start_Time_Tmp) ,(select count(*) from swt_rpt_base.AT_Apttus_Config2__LineItem__c where SWT_INS_DT::date = sysdate::date),'Y';
		
Commit;

/* Deleting partial audit entry */

/*DELETE FROM swt_rpt_stg.FAST_LD_AUDT where SUBJECT_AREA = 'APTTUS' and
TBL_NM = 'AT_Apttus_Config2__LineItem__c' and
COMPLTN_STAT = 'N' and
LD_DT=sysdate::date and 
SEQ_ID = (select max(SEQ_ID) from swt_rpt_stg.FAST_LD_AUDT where  SUBJECT_AREA = 'APTTUS' and  TBL_NM = 'AT_Apttus_Config2__LineItem__c' and  COMPLTN_STAT = 'N');

Commit;*/

SELECT DROP_PARTITION('swt_rpt_stg.AT_Apttus_Config2__LineItem__c_HIST', TIMESTAMPADD(day,-7,getdate())::date);
/*select do_tm_task('mergeout','swt_rpt_stg.AT_Apttus_Config2__LineItem__c_HIST');*/
select do_tm_task('mergeout','swt_rpt_base.AT_Apttus_Config2__LineItem__c');
select do_tm_task('mergeout','swt_rpt_stg.FAST_LD_AUDT');
SELECT ANALYZE_STATISTICS('swt_rpt_base.AT_Apttus_Config2__LineItem__c');





