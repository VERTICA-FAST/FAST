/****
****Script Name	  : AT_Apttus_Config2__OrderLineItem__c.sql
****Description   : Incremental data load for AT_Apttus_Config2__OrderLineItem__c
****/

/* Setting timing on**/
\timing

\set ON_ERROR_STOP on

CREATE LOCAL TEMP TABLE Start_Time_Tmp ON COMMIT PRESERVE ROWS AS select count(*) count, sysdate st from "swt_rpt_stg"."AT_Apttus_Config2__OrderLineItem__c";

/* Inserting values into Audit table  */

INSERT INTO swt_rpt_stg.FAST_LD_AUDT
(
SUBJECT_AREA
,TBL_NM
,LD_DT
,START_DT_TIME
,END_DT_TIME
,SRC_REC_CNT
,TGT_REC_CNT
,COMPLTN_STAT
)
select 'APTTUS','AT_Apttus_Config2__OrderLineItem__c',sysdate::date,sysdate,null,(select count from Start_Time_Tmp) ,null,'N';

Commit;


CREATE LOCAL TEMP TABLE AT_Apttus_Config2__OrderLineItem__c_stg_Tmp ON COMMIT PRESERVE ROWS AS
(
SELECT DISTINCT * FROM swt_rpt_stg.AT_Apttus_Config2__OrderLineItem__c)
SEGMENTED BY HASH(ID,LastModifiedDate) ALL NODES;

INSERT /*+DIRECT*/ INTO "swt_rpt_stg".AT_Apttus_Config2__OrderLineItem__c_Hist select * from "swt_rpt_stg".AT_Apttus_Config2__OrderLineItem__c;
COMMIT;
TRUNCATE TABLE swt_rpt_stg.AT_Apttus_Config2__OrderLineItem__c;

CREATE LOCAL TEMP TABLE AT_Apttus_Config2__OrderLineItem__c_base_Tmp ON COMMIT PRESERVE ROWS AS
(
SELECT DISTINCT ID,LastModifiedDate FROM swt_rpt_base.AT_Apttus_Config2__OrderLineItem__c)
SEGMENTED BY HASH(ID,LastModifiedDate) ALL NODES;


CREATE LOCAL TEMP TABLE AT_Apttus_Config2__OrderLineItem__c_stg_Tmp_Key ON COMMIT PRESERVE ROWS AS
(
SELECT id, max(LastModifiedDate) as LastModifiedDate FROM AT_Apttus_Config2__OrderLineItem__c_stg_Tmp group by id)
SEGMENTED BY HASH(ID,LastModifiedDate) ALL NODES;


/* Inserting deleted Stage table data into Historical Table */

insert /*+DIRECT*/ into swt_rpt_stg.AT_Apttus_Config2__OrderLineItem__c_Hist
(
Apttus_CMConfig__AgreementId__c
,Apttus_CMConfig__AgreementLineItemId__c
,Apttus_Config2__ActivatedDate__c
,Apttus_Config2__AdjustedPrice__c
,Apttus_Config2__AdjustmentAmount__c
,Apttus_Config2__AdjustmentType__c
,Apttus_Config2__AssetId__c
,Apttus_Config2__AssetLineItemId__c
,Apttus_Config2__AttributeValueId__c
,Apttus_Config2__AutoRenew__c
,Apttus_Config2__AutoRenewalTerm__c
,Apttus_Config2__AutoRenewalType__c
,Apttus_Config2__BaseCost__c
,Apttus_Config2__BaseCostOverride__c
,Apttus_Config2__BaseExtendedCost__c
,Apttus_Config2__BaseExtendedPrice__c
,Apttus_Config2__BasePrice__c
,Apttus_Config2__BasePriceMethod__c
,Apttus_Config2__BasePriceOverride__c
,Apttus_Config2__BaseProductId__c
,Apttus_Config2__BillingFrequency__c
,Apttus_Config2__BillingPlanId__c
,Apttus_Config2__BillingPreferenceId__c
,Apttus_Config2__BillingRule__c
,Apttus_Config2__BillToAccountId__c
,Apttus_Config2__CancelledDate__c
,Apttus_Config2__ChargeGroupId__c
,Apttus_Config2__ChargeType__c
,Apttus_Config2__ClassificationHierarchy__c
,Apttus_Config2__ClassificationId__c
,Apttus_Config2__Comments__c
,Apttus_Config2__CommitmentQuantity__c
,Apttus_Config2__ConfigurationId__c
,Apttus_Config2__ContractNumbers__c
,Apttus_Config2__Cost__c
,Apttus_Config2__CouponCode__c
,Apttus_Config2__DeltaPrice__c
,Apttus_Config2__DeltaQuantity__c
,Apttus_Config2__DerivedFromId__c
,Apttus_Config2__Description__c
,Apttus_Config2__EndDate__c
,Apttus_Config2__ExtendedCost__c
,Apttus_Config2__ExtendedDescription__c
,Apttus_Config2__ExtendedPrice__c
,Apttus_Config2__ExtendedQuantity__c
,Apttus_Config2__FlatOptionPrice__c
,Apttus_Config2__Frequency__c
,Apttus_Config2__FulfilledDate__c
,Apttus_Config2__FulfilledQuantity__c
,Apttus_Config2__GroupAdjustmentPercent__c
,Apttus_Config2__Guidance__c
,Apttus_Config2__HasAttributes__c
,Apttus_Config2__HasIncentives__c
,Apttus_Config2__HasOptions__c
,Apttus_Config2__HideInvoiceDisplay__c
,Apttus_Config2__ImpactARR__c
,Apttus_Config2__ImpactMRR__c
,Apttus_Config2__ImpactTCV__c
,Apttus_Config2__IncentiveAdjustmentAmount__c
,Apttus_Config2__IncentiveCode__c
,Apttus_Config2__IncentiveExtendedPrice__c
,Apttus_Config2__IncentiveId__c
,Apttus_Config2__IncentiveType__c
,Apttus_Config2__IsAssetPricing__c
,Apttus_Config2__IsCustomPricing__c
,Apttus_Config2__IsOptionRollupLine__c
,Apttus_Config2__IsPrimaryLine__c
,Apttus_Config2__IsPrimaryRampLine__c
,Apttus_Config2__IsUsageTierModifiable__c
,Apttus_Config2__ItemSequence__c
,Apttus_Config2__LineNumber__c
,Apttus_Config2__LineStatus__c
,Apttus_Config2__LineType__c
,Apttus_Config2__ListPrice__c
,Apttus_Config2__LocationId__c
,Apttus_Config2__MaxUsageQuantity__c
,Apttus_Config2__MinUsageQuantity__c
,Apttus_Config2__NetAdjustmentPercent__c
,Apttus_Config2__NetPrice__c
,Apttus_Config2__NetUnitPrice__c
,Apttus_Config2__OptionCost__c
,Apttus_Config2__OptionId__c
,Apttus_Config2__OptionPrice__c
,Apttus_Config2__OrderARR__c
,Apttus_Config2__OrderId__c
,Apttus_Config2__OrderMRR__c
,Apttus_Config2__OrderTCV__c
,Apttus_Config2__OriginalAssetLineItemId__c
,Apttus_Config2__ParentBundleNumber__c
,Apttus_Config2__PaymentTermId__c
,Apttus_Config2__PriceAdjustment__c
,Apttus_Config2__PriceAdjustmentAmount__c
,Apttus_Config2__PriceAdjustmentType__c
,Apttus_Config2__PriceGroup__c
,Apttus_Config2__PriceIncludedInBundle__c
,Apttus_Config2__PriceListId__c
,Apttus_Config2__PriceListItemId__c
,Apttus_Config2__PriceMethod__c
,Apttus_Config2__PriceType__c
,Apttus_Config2__PriceUom__c
,Apttus_Config2__PricingDate__c
,Apttus_Config2__PrimaryLineNumber__c
,Apttus_Config2__ProductId__c
,Apttus_Config2__ProductOptionId__c
,Apttus_Config2__Quantity__c
,Apttus_Config2__ReadyForBillingDate__c
,Apttus_Config2__ReadyForRevRecDate__c
,Apttus_Config2__RebateAmount__c
,Apttus_Config2__RenewalAdjustmentAmount__c
,Apttus_Config2__RenewalAdjustmentType__c
,Apttus_Config2__RevenueSplitPolicyId__c
,Apttus_Config2__RevRecPolicyId__c
,Apttus_Config2__SellingFrequency__c
,Apttus_Config2__SellingTerm__c
,Apttus_Config2__ServiceLocationId__c
,Apttus_Config2__ShipToAccountId__c
,Apttus_Config2__StartDate__c
,Apttus_Config2__Status__c
,Apttus_Config2__SubType__c
,Apttus_Config2__Taxable__c
,Apttus_Config2__TaxCodeId__c
,Apttus_Config2__TaxInclusive__c
,Apttus_Config2__Term__c
,Apttus_Config2__Type__c
,Apttus_Config2__Uom__c
,Apttus_QPConfig__ProposalId__c
,Apttus_QPConfig__ProposalLineItemId__c
,CreatedById
,CurrencyIsoCode
,Id
,LastModifiedById
,LastModifiedDate
,Name
,SWT_Additional_Discount__c
,SWT_Additional_Discount_Percentage__c
,SWT_Appliance_Serial_Number__c
,SWT_Authority_Currency_Code__c
,SWT_Billing_Plan__c
,SWT_Business_Area__c
,SWT_Business_Area_Formula__c
,SWT_Contractual_Discount_Amount__c
,SWT_Contractual_Discount_Percentage__c
,SWT_Cost_Center__c
,SWT_Entitlement_Id__c
,SWT_Expected_Start_Date__c
,SWT_Extended_List_Price__c
,SWT_Fulfilled_Date__c
,SWT_Functional_Area__c
,SWT_HPE_Grace_Period__c
,SWT_HPE_RampUp__c
,SWT_Jurisdiction_Text__c
,SWT_Merged_Subscription__c
,SWT_MRU__c
,SWT_New_Subscription_Rate_Plan_Charge_ID__c
,SWT_Old_Asset_Line_Item__c
,SWT_Old_Subscription_Rate_Plan_Charge_ID__c
,SWT_Old_Term__c
,SWT_Option_Support__c
,SWT_ParentOrderLineItem__c
,SWT_Partner_Discount_Amount__c
,SWT_Partner_Discount_Percentage__c
,SWT_PL__c
,SWT_Pricing_Method__c
,SWT_Product_Code__c
,SWT_Product_Config_Type__c
,SWT_Product_Sub_Type__c
,SWT_Product_Tax_Code__c
,SWT_Product_Type__c
,SWT_ProductRatePlanChargeID__c
,SWT_Profit_Center__c
,SWT_Promotion_Discount_Amount__c
,SWT_Promotional_Discount_Percentage__c
,SWT_Related_Product__c
,SWT_Remaining_Quantity__c
,SWT_Return_to_Support__c
,SWT_Ship_To_Account_Name__c
,SWT_Ship_To_Address__c
,SWT_Subscription_End_Date__c
,SWT_Subscription_ID__c
,SWT_Subscription_Start_Date__c
,SWT_Support_Business_Area__c
,SWT_Support_Entitlement_ID__c
,SWT_Tax_Rate_Code__c
,SWT_Tax_Type__c
,SWT_TaxAmount__c
,SWT_TaxCode__c
,SWT_TaxRate__c
,SWT_Term_Changed__c
,SWT_Tier_Type__c
,SWT_Tier_Type_Formula__c
,SWT_Total_Discount_Percentage__c
,SWT_Total_Discount_Value__c
,SWT_Update_Asset_Line_Item__c
,SWT_UpfrontBilling__c
,SWT_VSOE_lower_band__c
,SWT_VSOE_upper_band__c
,SWT_Zuora_Rate_Plan_Charge_ID__c
,SWT_Zuora_Subscription_Rate_Plan_ID__c
,SWT_Initial_Quantity_New_Business__c
,SWT_Product_Detail_Code__c
,SWT_Sold_By_Quantity__c
,SWT_UOM_code__c
,SWT_Control_Tower_ID__c
,SWT_New_Asset__c
,SWT_New_Asset_Line_Item__c
,SWT_DropShip_PO__c
,SWT_ELA_Agreement_Name__c
,SWT_ELA_Charge_Description__c
,SWT_ELA_Line_Item_Original_Balance__c
,SWT_Royalty_Bearing_or_Fixed_Quantity_1__c
,SWT_ELA_Adjustment_Quantity__c
,SWT_ELA_Upper_Fence__c
,SWT_ELA_Lower_Fence__c
,SWT_ELA_Maximum_Quantity__c
,SWT_ELA_Complimentary__c
,SWT_ELA_Complimetary_Discount__c
,SWT_ELA_Complimetary_Product_Price__c
,SWT_Bill_of_Lading__c
,SWT_Product_Billing_Plan__c
,SWT_Previous_Year_Support_Net_Price__c
,SWT_Previous_Year_License_Net_Price__c
,SWT_Charge_Description__c
,IsDeleted
,CreatedDate
,SystemModstamp
,LastActivityDate
,LastViewedDate
,LastReferencedDate
,SWT_Provisioned_Request_Date__c
,SWT_ELA_Royalty_Bearing_or_Fixed_Qty__c
,SWT_Appliance_fulfillment_date__c
,GS_Customer_Products__c
,Apttus_Config2_NetPrice_USD__c
,SWT_Additional_Discount_USD__c
,SWT_Contractual_Discount_Amount_USD__c
,SWT_Partner_Discount_Amount_USD__c
,SWT_Program_Discount_Amount_USD__c
,SWT_RevenueType__c
,SWT_Total_Discount_Value_USD__c
,SWT_Promotion_Discount_Amount_USD__c
,SWT_Original_Quantity__c
,SWT_Termination_Quantity__c
,SWT_ZuoraProductRatePlanID__c
,LD_DT
,SWT_INS_DT
,d_source
)
select
Apttus_CMConfig__AgreementId__c
,Apttus_CMConfig__AgreementLineItemId__c
,Apttus_Config2__ActivatedDate__c
,Apttus_Config2__AdjustedPrice__c
,Apttus_Config2__AdjustmentAmount__c
,Apttus_Config2__AdjustmentType__c
,Apttus_Config2__AssetId__c
,Apttus_Config2__AssetLineItemId__c
,Apttus_Config2__AttributeValueId__c
,Apttus_Config2__AutoRenew__c
,Apttus_Config2__AutoRenewalTerm__c
,Apttus_Config2__AutoRenewalType__c
,Apttus_Config2__BaseCost__c
,Apttus_Config2__BaseCostOverride__c
,Apttus_Config2__BaseExtendedCost__c
,Apttus_Config2__BaseExtendedPrice__c
,Apttus_Config2__BasePrice__c
,Apttus_Config2__BasePriceMethod__c
,Apttus_Config2__BasePriceOverride__c
,Apttus_Config2__BaseProductId__c
,Apttus_Config2__BillingFrequency__c
,Apttus_Config2__BillingPlanId__c
,Apttus_Config2__BillingPreferenceId__c
,Apttus_Config2__BillingRule__c
,Apttus_Config2__BillToAccountId__c
,Apttus_Config2__CancelledDate__c
,Apttus_Config2__ChargeGroupId__c
,Apttus_Config2__ChargeType__c
,Apttus_Config2__ClassificationHierarchy__c
,Apttus_Config2__ClassificationId__c
,Apttus_Config2__Comments__c
,Apttus_Config2__CommitmentQuantity__c
,Apttus_Config2__ConfigurationId__c
,Apttus_Config2__ContractNumbers__c
,Apttus_Config2__Cost__c
,Apttus_Config2__CouponCode__c
,Apttus_Config2__DeltaPrice__c
,Apttus_Config2__DeltaQuantity__c
,Apttus_Config2__DerivedFromId__c
,Apttus_Config2__Description__c
,Apttus_Config2__EndDate__c
,Apttus_Config2__ExtendedCost__c
,Apttus_Config2__ExtendedDescription__c
,Apttus_Config2__ExtendedPrice__c
,Apttus_Config2__ExtendedQuantity__c
,Apttus_Config2__FlatOptionPrice__c
,Apttus_Config2__Frequency__c
,Apttus_Config2__FulfilledDate__c
,Apttus_Config2__FulfilledQuantity__c
,Apttus_Config2__GroupAdjustmentPercent__c
,Apttus_Config2__Guidance__c
,Apttus_Config2__HasAttributes__c
,Apttus_Config2__HasIncentives__c
,Apttus_Config2__HasOptions__c
,Apttus_Config2__HideInvoiceDisplay__c
,Apttus_Config2__ImpactARR__c
,Apttus_Config2__ImpactMRR__c
,Apttus_Config2__ImpactTCV__c
,Apttus_Config2__IncentiveAdjustmentAmount__c
,Apttus_Config2__IncentiveCode__c
,Apttus_Config2__IncentiveExtendedPrice__c
,Apttus_Config2__IncentiveId__c
,Apttus_Config2__IncentiveType__c
,Apttus_Config2__IsAssetPricing__c
,Apttus_Config2__IsCustomPricing__c
,Apttus_Config2__IsOptionRollupLine__c
,Apttus_Config2__IsPrimaryLine__c
,Apttus_Config2__IsPrimaryRampLine__c
,Apttus_Config2__IsUsageTierModifiable__c
,Apttus_Config2__ItemSequence__c
,Apttus_Config2__LineNumber__c
,Apttus_Config2__LineStatus__c
,Apttus_Config2__LineType__c
,Apttus_Config2__ListPrice__c
,Apttus_Config2__LocationId__c
,Apttus_Config2__MaxUsageQuantity__c
,Apttus_Config2__MinUsageQuantity__c
,Apttus_Config2__NetAdjustmentPercent__c
,Apttus_Config2__NetPrice__c
,Apttus_Config2__NetUnitPrice__c
,Apttus_Config2__OptionCost__c
,Apttus_Config2__OptionId__c
,Apttus_Config2__OptionPrice__c
,Apttus_Config2__OrderARR__c
,Apttus_Config2__OrderId__c
,Apttus_Config2__OrderMRR__c
,Apttus_Config2__OrderTCV__c
,Apttus_Config2__OriginalAssetLineItemId__c
,Apttus_Config2__ParentBundleNumber__c
,Apttus_Config2__PaymentTermId__c
,Apttus_Config2__PriceAdjustment__c
,Apttus_Config2__PriceAdjustmentAmount__c
,Apttus_Config2__PriceAdjustmentType__c
,Apttus_Config2__PriceGroup__c
,Apttus_Config2__PriceIncludedInBundle__c
,Apttus_Config2__PriceListId__c
,Apttus_Config2__PriceListItemId__c
,Apttus_Config2__PriceMethod__c
,Apttus_Config2__PriceType__c
,Apttus_Config2__PriceUom__c
,Apttus_Config2__PricingDate__c
,Apttus_Config2__PrimaryLineNumber__c
,Apttus_Config2__ProductId__c
,Apttus_Config2__ProductOptionId__c
,Apttus_Config2__Quantity__c
,Apttus_Config2__ReadyForBillingDate__c
,Apttus_Config2__ReadyForRevRecDate__c
,Apttus_Config2__RebateAmount__c
,Apttus_Config2__RenewalAdjustmentAmount__c
,Apttus_Config2__RenewalAdjustmentType__c
,Apttus_Config2__RevenueSplitPolicyId__c
,Apttus_Config2__RevRecPolicyId__c
,Apttus_Config2__SellingFrequency__c
,Apttus_Config2__SellingTerm__c
,Apttus_Config2__ServiceLocationId__c
,Apttus_Config2__ShipToAccountId__c
,Apttus_Config2__StartDate__c
,Apttus_Config2__Status__c
,Apttus_Config2__SubType__c
,Apttus_Config2__Taxable__c
,Apttus_Config2__TaxCodeId__c
,Apttus_Config2__TaxInclusive__c
,Apttus_Config2__Term__c
,Apttus_Config2__Type__c
,Apttus_Config2__Uom__c
,Apttus_QPConfig__ProposalId__c
,Apttus_QPConfig__ProposalLineItemId__c
,CreatedById
,CurrencyIsoCode
,Id
,LastModifiedById
,LastModifiedDate
,Name
,SWT_Additional_Discount__c
,SWT_Additional_Discount_Percentage__c
,SWT_Appliance_Serial_Number__c
,SWT_Authority_Currency_Code__c
,SWT_Billing_Plan__c
,SWT_Business_Area__c
,SWT_Business_Area_Formula__c
,SWT_Contractual_Discount_Amount__c
,SWT_Contractual_Discount_Percentage__c
,SWT_Cost_Center__c
,SWT_Entitlement_Id__c
,SWT_Expected_Start_Date__c
,SWT_Extended_List_Price__c
,SWT_Fulfilled_Date__c
,SWT_Functional_Area__c
,SWT_HPE_Grace_Period__c
,SWT_HPE_RampUp__c
,SWT_Jurisdiction_Text__c
,SWT_Merged_Subscription__c
,SWT_MRU__c
,SWT_New_Subscription_Rate_Plan_Charge_ID__c
,SWT_Old_Asset_Line_Item__c
,SWT_Old_Subscription_Rate_Plan_Charge_ID__c
,SWT_Old_Term__c
,SWT_Option_Support__c
,SWT_ParentOrderLineItem__c
,SWT_Partner_Discount_Amount__c
,SWT_Partner_Discount_Percentage__c
,SWT_PL__c
,SWT_Pricing_Method__c
,SWT_Product_Code__c
,SWT_Product_Config_Type__c
,SWT_Product_Sub_Type__c
,SWT_Product_Tax_Code__c
,SWT_Product_Type__c
,SWT_ProductRatePlanChargeID__c
,SWT_Profit_Center__c
,SWT_Promotion_Discount_Amount__c
,SWT_Promotional_Discount_Percentage__c
,SWT_Related_Product__c
,SWT_Remaining_Quantity__c
,SWT_Return_to_Support__c
,SWT_Ship_To_Account_Name__c
,SWT_Ship_To_Address__c
,SWT_Subscription_End_Date__c
,SWT_Subscription_ID__c
,SWT_Subscription_Start_Date__c
,SWT_Support_Business_Area__c
,SWT_Support_Entitlement_ID__c
,SWT_Tax_Rate_Code__c
,SWT_Tax_Type__c
,SWT_TaxAmount__c
,SWT_TaxCode__c
,SWT_TaxRate__c
,SWT_Term_Changed__c
,SWT_Tier_Type__c
,SWT_Tier_Type_Formula__c
,SWT_Total_Discount_Percentage__c
,SWT_Total_Discount_Value__c
,SWT_Update_Asset_Line_Item__c
,SWT_UpfrontBilling__c
,SWT_VSOE_lower_band__c
,SWT_VSOE_upper_band__c
,SWT_Zuora_Rate_Plan_Charge_ID__c
,SWT_Zuora_Subscription_Rate_Plan_ID__c
,SWT_Initial_Quantity_New_Business__c
,SWT_Product_Detail_Code__c
,SWT_Sold_By_Quantity__c
,SWT_UOM_code__c
,SWT_Control_Tower_ID__c
,SWT_New_Asset__c
,SWT_New_Asset_Line_Item__c
,SWT_DropShip_PO__c
,SWT_ELA_Agreement_Name__c
,SWT_ELA_Charge_Description__c
,SWT_ELA_Line_Item_Original_Balance__c
,SWT_Royalty_Bearing_or_Fixed_Quantity_1__c
,SWT_ELA_Adjustment_Quantity__c
,SWT_ELA_Upper_Fence__c
,SWT_ELA_Lower_Fence__c
,SWT_ELA_Maximum_Quantity__c
,SWT_ELA_Complimentary__c
,SWT_ELA_Complimetary_Discount__c
,SWT_ELA_Complimetary_Product_Price__c
,SWT_Bill_of_Lading__c
,SWT_Product_Billing_Plan__c
,SWT_Previous_Year_Support_Net_Price__c
,SWT_Previous_Year_License_Net_Price__c
,SWT_Charge_Description__c
,IsDeleted
,CreatedDate
,SystemModstamp
,LastActivityDate
,LastViewedDate
,LastReferencedDate
,SWT_Provisioned_Request_Date__c
,SWT_ELA_Royalty_Bearing_or_Fixed_Qty__c
,SWT_Appliance_fulfillment_date__c
,GS_Customer_Products__c
,Apttus_Config2_NetPrice_USD__c
,SWT_Additional_Discount_USD__c
,SWT_Contractual_Discount_Amount_USD__c
,SWT_Partner_Discount_Amount_USD__c
,SWT_Program_Discount_Amount_USD__c
,SWT_RevenueType__c
,SWT_Total_Discount_Value_USD__c
,SWT_Promotion_Discount_Amount_USD__c
,SWT_Original_Quantity__c
,SWT_Termination_Quantity__c
,SWT_ZuoraProductRatePlanID__c
,SYSDATE AS LD_DT
,SWT_INS_DT
,'base'
FROM "swt_rpt_base".AT_Apttus_Config2__OrderLineItem__c WHERE id in
(SELECT STG.id FROM AT_Apttus_Config2__OrderLineItem__c_stg_Tmp_Key STG JOIN AT_Apttus_Config2__OrderLineItem__c_base_Tmp
ON STG.id = AT_Apttus_Config2__OrderLineItem__c_base_Tmp.id AND STG.LastModifiedDate >= AT_Apttus_Config2__OrderLineItem__c_base_Tmp.LastModifiedDate);

/* Deleting before seven days data from current date in the Historical Table */

delete /*+DIRECT*/ from "swt_rpt_stg"."AT_Apttus_Config2__OrderLineItem__c_Hist"  where LD_DT::date <= TIMESTAMPADD(DAY,-7,sysdate)::date;


/* Incremental VSQL script for loading data from Stage to Base */

DELETE /*+DIRECT*/ FROM "swt_rpt_base".AT_Apttus_Config2__OrderLineItem__c WHERE id in
(SELECT STG.id FROM AT_Apttus_Config2__OrderLineItem__c_stg_Tmp_Key STG JOIN AT_Apttus_Config2__OrderLineItem__c_base_Tmp
ON STG.id = AT_Apttus_Config2__OrderLineItem__c_base_Tmp.id AND STG.LastModifiedDate >= AT_Apttus_Config2__OrderLineItem__c_base_Tmp.LastModifiedDate);


INSERT /*+DIRECT*/ INTO "swt_rpt_base".AT_Apttus_Config2__OrderLineItem__c
(
Apttus_CMConfig__AgreementId__c
,Apttus_CMConfig__AgreementLineItemId__c
,Apttus_Config2__ActivatedDate__c
,Apttus_Config2__AdjustedPrice__c
,Apttus_Config2__AdjustmentAmount__c
,Apttus_Config2__AdjustmentType__c
,Apttus_Config2__AssetId__c
,Apttus_Config2__AssetLineItemId__c
,Apttus_Config2__AttributeValueId__c
,Apttus_Config2__AutoRenew__c
,Apttus_Config2__AutoRenewalTerm__c
,Apttus_Config2__AutoRenewalType__c
,Apttus_Config2__BaseCost__c
,Apttus_Config2__BaseCostOverride__c
,Apttus_Config2__BaseExtendedCost__c
,Apttus_Config2__BaseExtendedPrice__c
,Apttus_Config2__BasePrice__c
,Apttus_Config2__BasePriceMethod__c
,Apttus_Config2__BasePriceOverride__c
,Apttus_Config2__BaseProductId__c
,Apttus_Config2__BillingFrequency__c
,Apttus_Config2__BillingPlanId__c
,Apttus_Config2__BillingPreferenceId__c
,Apttus_Config2__BillingRule__c
,Apttus_Config2__BillToAccountId__c
,Apttus_Config2__CancelledDate__c
,Apttus_Config2__ChargeGroupId__c
,Apttus_Config2__ChargeType__c
,Apttus_Config2__ClassificationHierarchy__c
,Apttus_Config2__ClassificationId__c
,Apttus_Config2__Comments__c
,Apttus_Config2__CommitmentQuantity__c
,Apttus_Config2__ConfigurationId__c
,Apttus_Config2__ContractNumbers__c
,Apttus_Config2__Cost__c
,Apttus_Config2__CouponCode__c
,Apttus_Config2__DeltaPrice__c
,Apttus_Config2__DeltaQuantity__c
,Apttus_Config2__DerivedFromId__c
,Apttus_Config2__Description__c
,Apttus_Config2__EndDate__c
,Apttus_Config2__ExtendedCost__c
,Apttus_Config2__ExtendedDescription__c
,Apttus_Config2__ExtendedPrice__c
,Apttus_Config2__ExtendedQuantity__c
,Apttus_Config2__FlatOptionPrice__c
,Apttus_Config2__Frequency__c
,Apttus_Config2__FulfilledDate__c
,Apttus_Config2__FulfilledQuantity__c
,Apttus_Config2__GroupAdjustmentPercent__c
,Apttus_Config2__Guidance__c
,Apttus_Config2__HasAttributes__c
,Apttus_Config2__HasIncentives__c
,Apttus_Config2__HasOptions__c
,Apttus_Config2__HideInvoiceDisplay__c
,Apttus_Config2__ImpactARR__c
,Apttus_Config2__ImpactMRR__c
,Apttus_Config2__ImpactTCV__c
,Apttus_Config2__IncentiveAdjustmentAmount__c
,Apttus_Config2__IncentiveCode__c
,Apttus_Config2__IncentiveExtendedPrice__c
,Apttus_Config2__IncentiveId__c
,Apttus_Config2__IncentiveType__c
,Apttus_Config2__IsAssetPricing__c
,Apttus_Config2__IsCustomPricing__c
,Apttus_Config2__IsOptionRollupLine__c
,Apttus_Config2__IsPrimaryLine__c
,Apttus_Config2__IsPrimaryRampLine__c
,Apttus_Config2__IsUsageTierModifiable__c
,Apttus_Config2__ItemSequence__c
,Apttus_Config2__LineNumber__c
,Apttus_Config2__LineStatus__c
,Apttus_Config2__LineType__c
,Apttus_Config2__ListPrice__c
,Apttus_Config2__LocationId__c
,Apttus_Config2__MaxUsageQuantity__c
,Apttus_Config2__MinUsageQuantity__c
,Apttus_Config2__NetAdjustmentPercent__c
,Apttus_Config2__NetPrice__c
,Apttus_Config2__NetUnitPrice__c
,Apttus_Config2__OptionCost__c
,Apttus_Config2__OptionId__c
,Apttus_Config2__OptionPrice__c
,Apttus_Config2__OrderARR__c
,Apttus_Config2__OrderId__c
,Apttus_Config2__OrderMRR__c
,Apttus_Config2__OrderTCV__c
,Apttus_Config2__OriginalAssetLineItemId__c
,Apttus_Config2__ParentBundleNumber__c
,Apttus_Config2__PaymentTermId__c
,Apttus_Config2__PriceAdjustment__c
,Apttus_Config2__PriceAdjustmentAmount__c
,Apttus_Config2__PriceAdjustmentType__c
,Apttus_Config2__PriceGroup__c
,Apttus_Config2__PriceIncludedInBundle__c
,Apttus_Config2__PriceListId__c
,Apttus_Config2__PriceListItemId__c
,Apttus_Config2__PriceMethod__c
,Apttus_Config2__PriceType__c
,Apttus_Config2__PriceUom__c
,Apttus_Config2__PricingDate__c
,Apttus_Config2__PrimaryLineNumber__c
,Apttus_Config2__ProductId__c
,Apttus_Config2__ProductOptionId__c
,Apttus_Config2__Quantity__c
,Apttus_Config2__ReadyForBillingDate__c
,Apttus_Config2__ReadyForRevRecDate__c
,Apttus_Config2__RebateAmount__c
,Apttus_Config2__RenewalAdjustmentAmount__c
,Apttus_Config2__RenewalAdjustmentType__c
,Apttus_Config2__RevenueSplitPolicyId__c
,Apttus_Config2__RevRecPolicyId__c
,Apttus_Config2__SellingFrequency__c
,Apttus_Config2__SellingTerm__c
,Apttus_Config2__ServiceLocationId__c
,Apttus_Config2__ShipToAccountId__c
,Apttus_Config2__StartDate__c
,Apttus_Config2__Status__c
,Apttus_Config2__SubType__c
,Apttus_Config2__Taxable__c
,Apttus_Config2__TaxCodeId__c
,Apttus_Config2__TaxInclusive__c
,Apttus_Config2__Term__c
,Apttus_Config2__Type__c
,Apttus_Config2__Uom__c
,Apttus_QPConfig__ProposalId__c
,Apttus_QPConfig__ProposalLineItemId__c
,CreatedById
,CurrencyIsoCode
,Id
,LastModifiedById
,LastModifiedDate
,Name
,SWT_Additional_Discount__c
,SWT_Additional_Discount_Percentage__c
,SWT_Appliance_Serial_Number__c
,SWT_Authority_Currency_Code__c
,SWT_Billing_Plan__c
,SWT_Business_Area__c
,SWT_Business_Area_Formula__c
,SWT_Contractual_Discount_Amount__c
,SWT_Contractual_Discount_Percentage__c
,SWT_Cost_Center__c
,SWT_Entitlement_Id__c
,SWT_Expected_Start_Date__c
,SWT_Extended_List_Price__c
,SWT_Fulfilled_Date__c
,SWT_Functional_Area__c
,SWT_HPE_Grace_Period__c
,SWT_HPE_RampUp__c
,SWT_Jurisdiction_Text__c
,SWT_Merged_Subscription__c
,SWT_MRU__c
,SWT_New_Subscription_Rate_Plan_Charge_ID__c
,SWT_Old_Asset_Line_Item__c
,SWT_Old_Subscription_Rate_Plan_Charge_ID__c
,SWT_Old_Term__c
,SWT_Option_Support__c
,SWT_ParentOrderLineItem__c
,SWT_Partner_Discount_Amount__c
,SWT_Partner_Discount_Percentage__c
,SWT_PL__c
,SWT_Pricing_Method__c
,SWT_Product_Code__c
,SWT_Product_Config_Type__c
,SWT_Product_Sub_Type__c
,SWT_Product_Tax_Code__c
,SWT_Product_Type__c
,SWT_ProductRatePlanChargeID__c
,SWT_Profit_Center__c
,SWT_Promotion_Discount_Amount__c
,SWT_Promotional_Discount_Percentage__c
,SWT_Related_Product__c
,SWT_Remaining_Quantity__c
,SWT_Return_to_Support__c
,SWT_Ship_To_Account_Name__c
,SWT_Ship_To_Address__c
,SWT_Subscription_End_Date__c
,SWT_Subscription_ID__c
,SWT_Subscription_Start_Date__c
,SWT_Support_Business_Area__c
,SWT_Support_Entitlement_ID__c
,SWT_Tax_Rate_Code__c
,SWT_Tax_Type__c
,SWT_TaxAmount__c
,SWT_TaxCode__c
,SWT_TaxRate__c
,SWT_Term_Changed__c
,SWT_Tier_Type__c
,SWT_Tier_Type_Formula__c
,SWT_Total_Discount_Percentage__c
,SWT_Total_Discount_Value__c
,SWT_Update_Asset_Line_Item__c
,SWT_UpfrontBilling__c
,SWT_VSOE_lower_band__c
,SWT_VSOE_upper_band__c
,SWT_Zuora_Rate_Plan_Charge_ID__c
,SWT_Zuora_Subscription_Rate_Plan_ID__c
,SWT_Initial_Quantity_New_Business__c
,SWT_Product_Detail_Code__c
,SWT_Sold_By_Quantity__c
,SWT_UOM_code__c
,SWT_Control_Tower_ID__c
,SWT_New_Asset__c
,SWT_New_Asset_Line_Item__c
,SWT_DropShip_PO__c
,SWT_ELA_Agreement_Name__c
,SWT_ELA_Charge_Description__c
,SWT_ELA_Line_Item_Original_Balance__c
,SWT_Royalty_Bearing_or_Fixed_Quantity_1__c
,SWT_ELA_Adjustment_Quantity__c
,SWT_ELA_Upper_Fence__c
,SWT_ELA_Lower_Fence__c
,SWT_ELA_Maximum_Quantity__c
,SWT_ELA_Complimentary__c
,SWT_ELA_Complimetary_Discount__c
,SWT_ELA_Complimetary_Product_Price__c
,SWT_Bill_of_Lading__c
,SWT_Product_Billing_Plan__c
,SWT_Previous_Year_Support_Net_Price__c
,SWT_Previous_Year_License_Net_Price__c
,SWT_Charge_Description__c
,IsDeleted
,CreatedDate
,SystemModstamp
,LastActivityDate
,LastViewedDate
,LastReferencedDate
,SWT_Provisioned_Request_Date__c
,SWT_ELA_Royalty_Bearing_or_Fixed_Qty__c
,SWT_Appliance_fulfillment_date__c
,GS_Customer_Products__c
,Apttus_Config2_NetPrice_USD__c
,SWT_Additional_Discount_USD__c
,SWT_Contractual_Discount_Amount_USD__c
,SWT_Partner_Discount_Amount_USD__c
,SWT_Program_Discount_Amount_USD__c
,SWT_RevenueType__c
,SWT_Total_Discount_Value_USD__c
,SWT_Promotion_Discount_Amount_USD__c
,SWT_Original_Quantity__c
,SWT_Termination_Quantity__c
,SWT_ZuoraProductRatePlanID__c
,SWT_INS_DT
)
SELECT DISTINCT 
Apttus_CMConfig__AgreementId__c
,Apttus_CMConfig__AgreementLineItemId__c
,Apttus_Config2__ActivatedDate__c
,Apttus_Config2__AdjustedPrice__c
,Apttus_Config2__AdjustmentAmount__c
,Apttus_Config2__AdjustmentType__c
,Apttus_Config2__AssetId__c
,Apttus_Config2__AssetLineItemId__c
,Apttus_Config2__AttributeValueId__c
,Apttus_Config2__AutoRenew__c
,Apttus_Config2__AutoRenewalTerm__c
,Apttus_Config2__AutoRenewalType__c
,Apttus_Config2__BaseCost__c
,Apttus_Config2__BaseCostOverride__c
,Apttus_Config2__BaseExtendedCost__c
,Apttus_Config2__BaseExtendedPrice__c
,Apttus_Config2__BasePrice__c
,Apttus_Config2__BasePriceMethod__c
,Apttus_Config2__BasePriceOverride__c
,Apttus_Config2__BaseProductId__c
,Apttus_Config2__BillingFrequency__c
,Apttus_Config2__BillingPlanId__c
,Apttus_Config2__BillingPreferenceId__c
,Apttus_Config2__BillingRule__c
,Apttus_Config2__BillToAccountId__c
,Apttus_Config2__CancelledDate__c
,Apttus_Config2__ChargeGroupId__c
,Apttus_Config2__ChargeType__c
,Apttus_Config2__ClassificationHierarchy__c
,Apttus_Config2__ClassificationId__c
,Apttus_Config2__Comments__c
,Apttus_Config2__CommitmentQuantity__c
,Apttus_Config2__ConfigurationId__c
,Apttus_Config2__ContractNumbers__c
,Apttus_Config2__Cost__c
,Apttus_Config2__CouponCode__c
,Apttus_Config2__DeltaPrice__c
,Apttus_Config2__DeltaQuantity__c
,Apttus_Config2__DerivedFromId__c
,Apttus_Config2__Description__c
,Apttus_Config2__EndDate__c
,Apttus_Config2__ExtendedCost__c
,Apttus_Config2__ExtendedDescription__c
,Apttus_Config2__ExtendedPrice__c
,Apttus_Config2__ExtendedQuantity__c
,Apttus_Config2__FlatOptionPrice__c
,Apttus_Config2__Frequency__c
,Apttus_Config2__FulfilledDate__c
,Apttus_Config2__FulfilledQuantity__c
,Apttus_Config2__GroupAdjustmentPercent__c
,Apttus_Config2__Guidance__c
,Apttus_Config2__HasAttributes__c
,Apttus_Config2__HasIncentives__c
,Apttus_Config2__HasOptions__c
,Apttus_Config2__HideInvoiceDisplay__c
,Apttus_Config2__ImpactARR__c
,Apttus_Config2__ImpactMRR__c
,Apttus_Config2__ImpactTCV__c
,Apttus_Config2__IncentiveAdjustmentAmount__c
,Apttus_Config2__IncentiveCode__c
,Apttus_Config2__IncentiveExtendedPrice__c
,Apttus_Config2__IncentiveId__c
,Apttus_Config2__IncentiveType__c
,Apttus_Config2__IsAssetPricing__c
,Apttus_Config2__IsCustomPricing__c
,Apttus_Config2__IsOptionRollupLine__c
,Apttus_Config2__IsPrimaryLine__c
,Apttus_Config2__IsPrimaryRampLine__c
,Apttus_Config2__IsUsageTierModifiable__c
,Apttus_Config2__ItemSequence__c
,Apttus_Config2__LineNumber__c
,Apttus_Config2__LineStatus__c
,Apttus_Config2__LineType__c
,Apttus_Config2__ListPrice__c
,Apttus_Config2__LocationId__c
,Apttus_Config2__MaxUsageQuantity__c
,Apttus_Config2__MinUsageQuantity__c
,Apttus_Config2__NetAdjustmentPercent__c
,Apttus_Config2__NetPrice__c
,Apttus_Config2__NetUnitPrice__c
,Apttus_Config2__OptionCost__c
,Apttus_Config2__OptionId__c
,Apttus_Config2__OptionPrice__c
,Apttus_Config2__OrderARR__c
,Apttus_Config2__OrderId__c
,Apttus_Config2__OrderMRR__c
,Apttus_Config2__OrderTCV__c
,Apttus_Config2__OriginalAssetLineItemId__c
,Apttus_Config2__ParentBundleNumber__c
,Apttus_Config2__PaymentTermId__c
,Apttus_Config2__PriceAdjustment__c
,Apttus_Config2__PriceAdjustmentAmount__c
,Apttus_Config2__PriceAdjustmentType__c
,Apttus_Config2__PriceGroup__c
,Apttus_Config2__PriceIncludedInBundle__c
,Apttus_Config2__PriceListId__c
,Apttus_Config2__PriceListItemId__c
,Apttus_Config2__PriceMethod__c
,Apttus_Config2__PriceType__c
,Apttus_Config2__PriceUom__c
,Apttus_Config2__PricingDate__c
,Apttus_Config2__PrimaryLineNumber__c
,Apttus_Config2__ProductId__c
,Apttus_Config2__ProductOptionId__c
,Apttus_Config2__Quantity__c
,Apttus_Config2__ReadyForBillingDate__c
,Apttus_Config2__ReadyForRevRecDate__c
,Apttus_Config2__RebateAmount__c
,Apttus_Config2__RenewalAdjustmentAmount__c
,Apttus_Config2__RenewalAdjustmentType__c
,Apttus_Config2__RevenueSplitPolicyId__c
,Apttus_Config2__RevRecPolicyId__c
,Apttus_Config2__SellingFrequency__c
,Apttus_Config2__SellingTerm__c
,Apttus_Config2__ServiceLocationId__c
,Apttus_Config2__ShipToAccountId__c
,Apttus_Config2__StartDate__c
,Apttus_Config2__Status__c
,Apttus_Config2__SubType__c
,Apttus_Config2__Taxable__c
,Apttus_Config2__TaxCodeId__c
,Apttus_Config2__TaxInclusive__c
,Apttus_Config2__Term__c
,Apttus_Config2__Type__c
,Apttus_Config2__Uom__c
,Apttus_QPConfig__ProposalId__c
,Apttus_QPConfig__ProposalLineItemId__c
,CreatedById
,CurrencyIsoCode
,AT_Apttus_Config2__OrderLineItem__c_stg_Tmp.Id
,LastModifiedById
,AT_Apttus_Config2__OrderLineItem__c_stg_Tmp.LastModifiedDate
,Name
,SWT_Additional_Discount__c
,SWT_Additional_Discount_Percentage__c
,SWT_Appliance_Serial_Number__c
,SWT_Authority_Currency_Code__c
,SWT_Billing_Plan__c
,SWT_Business_Area__c
,SWT_Business_Area_Formula__c
,SWT_Contractual_Discount_Amount__c
,SWT_Contractual_Discount_Percentage__c
,SWT_Cost_Center__c
,SWT_Entitlement_Id__c
,SWT_Expected_Start_Date__c
,SWT_Extended_List_Price__c
,SWT_Fulfilled_Date__c
,SWT_Functional_Area__c
,SWT_HPE_Grace_Period__c
,SWT_HPE_RampUp__c
,SWT_Jurisdiction_Text__c
,SWT_Merged_Subscription__c
,SWT_MRU__c
,SWT_New_Subscription_Rate_Plan_Charge_ID__c
,SWT_Old_Asset_Line_Item__c
,SWT_Old_Subscription_Rate_Plan_Charge_ID__c
,SWT_Old_Term__c
,SWT_Option_Support__c
,SWT_ParentOrderLineItem__c
,SWT_Partner_Discount_Amount__c
,SWT_Partner_Discount_Percentage__c
,SWT_PL__c
,SWT_Pricing_Method__c
,SWT_Product_Code__c
,SWT_Product_Config_Type__c
,SWT_Product_Sub_Type__c
,SWT_Product_Tax_Code__c
,SWT_Product_Type__c
,SWT_ProductRatePlanChargeID__c
,SWT_Profit_Center__c
,SWT_Promotion_Discount_Amount__c
,SWT_Promotional_Discount_Percentage__c
,SWT_Related_Product__c
,SWT_Remaining_Quantity__c
,SWT_Return_to_Support__c
,SWT_Ship_To_Account_Name__c
,SWT_Ship_To_Address__c
,SWT_Subscription_End_Date__c
,SWT_Subscription_ID__c
,SWT_Subscription_Start_Date__c
,SWT_Support_Business_Area__c
,SWT_Support_Entitlement_ID__c
,SWT_Tax_Rate_Code__c
,SWT_Tax_Type__c
,SWT_TaxAmount__c
,SWT_TaxCode__c
,SWT_TaxRate__c
,SWT_Term_Changed__c
,SWT_Tier_Type__c
,SWT_Tier_Type_Formula__c
,SWT_Total_Discount_Percentage__c
,SWT_Total_Discount_Value__c
,SWT_Update_Asset_Line_Item__c
,SWT_UpfrontBilling__c
,SWT_VSOE_lower_band__c
,SWT_VSOE_upper_band__c
,SWT_Zuora_Rate_Plan_Charge_ID__c
,SWT_Zuora_Subscription_Rate_Plan_ID__c
,SWT_Initial_Quantity_New_Business__c
,SWT_Product_Detail_Code__c
,SWT_Sold_By_Quantity__c
,SWT_UOM_code__c
,SWT_Control_Tower_ID__c
,SWT_New_Asset__c
,SWT_New_Asset_Line_Item__c
,SWT_DropShip_PO__c
,SWT_ELA_Agreement_Name__c
,SWT_ELA_Charge_Description__c
,SWT_ELA_Line_Item_Original_Balance__c
,SWT_Royalty_Bearing_or_Fixed_Quantity_1__c
,SWT_ELA_Adjustment_Quantity__c
,SWT_ELA_Upper_Fence__c
,SWT_ELA_Lower_Fence__c
,SWT_ELA_Maximum_Quantity__c
,SWT_ELA_Complimentary__c
,SWT_ELA_Complimetary_Discount__c
,SWT_ELA_Complimetary_Product_Price__c
,SWT_Bill_of_Lading__c
,SWT_Product_Billing_Plan__c
,SWT_Previous_Year_Support_Net_Price__c
,SWT_Previous_Year_License_Net_Price__c
,SWT_Charge_Description__c
,IsDeleted
,CreatedDate
,SystemModstamp
,LastActivityDate
,LastViewedDate
,LastReferencedDate
,SWT_Provisioned_Request_Date__c
,SWT_ELA_Royalty_Bearing_or_Fixed_Qty__c
,SWT_Appliance_fulfillment_date__c
,GS_Customer_Products__c
,Apttus_Config2_NetPrice_USD__c
,SWT_Additional_Discount_USD__c
,SWT_Contractual_Discount_Amount_USD__c
,SWT_Partner_Discount_Amount_USD__c
,SWT_Program_Discount_Amount_USD__c
,SWT_RevenueType__c
,SWT_Total_Discount_Value_USD__c
,SWT_Promotion_Discount_Amount_USD__c
,SWT_Original_Quantity__c
,SWT_Termination_Quantity__c
,SWT_ZuoraProductRatePlanID__c
,SYSDATE
FROM AT_Apttus_Config2__OrderLineItem__c_stg_Tmp JOIN AT_Apttus_Config2__OrderLineItem__c_stg_Tmp_Key ON AT_Apttus_Config2__OrderLineItem__c_stg_Tmp.id= AT_Apttus_Config2__OrderLineItem__c_stg_Tmp_Key.id AND AT_Apttus_Config2__OrderLineItem__c_stg_Tmp.LastModifiedDate=AT_Apttus_Config2__OrderLineItem__c_stg_Tmp_Key.LastModifiedDate
WHERE NOT EXISTS
(SELECT 1 FROM "swt_rpt_base".AT_Apttus_Config2__OrderLineItem__c BASE
WHERE AT_Apttus_Config2__OrderLineItem__c_stg_Tmp.id = BASE.id);

/* Deleting partial audit entry */

DELETE FROM swt_rpt_stg.FAST_LD_AUDT where SUBJECT_AREA = 'APTTUS' and
TBL_NM = 'AT_Apttus_Config2__OrderLineItem__c' and
COMPLTN_STAT = 'N' and
LD_DT=sysdate::date and 
SEQ_ID = (select max(SEQ_ID) from swt_rpt_stg.FAST_LD_AUDT where  SUBJECT_AREA = 'APTTUS' and  TBL_NM = 'AT_Apttus_Config2__OrderLineItem__c' and  COMPLTN_STAT = 'N');


/* Inserting new audit entry with all stats */

INSERT INTO swt_rpt_stg.FAST_LD_AUDT
(
SUBJECT_AREA
,TBL_NM
,LD_DT
,START_DT_TIME
,END_DT_TIME
,SRC_REC_CNT
,TGT_REC_CNT
,COMPLTN_STAT
)
select 'APTTUS','AT_Apttus_Config2__OrderLineItem__c',sysdate::date,(select st from Start_Time_Tmp),sysdate,(select count from Start_Time_Tmp) ,(select count(*) from swt_rpt_base.AT_Apttus_Config2__OrderLineItem__c where SWT_INS_DT::date = sysdate::date),'Y';


Commit;


select do_tm_task('mergeout','swt_rpt_stg.AT_Apttus_Config2__OrderLineItem__c_Hist');
select do_tm_task('mergeout','swt_rpt_base.AT_Apttus_Config2__OrderLineItem__c');
select do_tm_task('mergeout','swt_rpt_stg.FAST_LD_AUDT');
SELECT ANALYZE_STATISTICS('swt_rpt_base.AT_Apttus_Config2__OrderLineItem__c');



