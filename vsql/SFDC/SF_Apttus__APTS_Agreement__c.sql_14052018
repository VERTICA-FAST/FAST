/****
****Script Name   : SF_Apttus__APTS_Agreement__c.sql
****Description   : Incremental data load for SF_Apttus__APTS_Agreement__c
****/
/*Setting timing on */
\timing

/**SET SESSION AUTOCOMMIT TO OFF;**/

--SET SESSION AUTOCOMMIT TO OFF;

\set ON_ERROR_STOP on

CREATE LOCAL TEMP TABLE Start_Time_Tmp ON COMMIT PRESERVE ROWS AS select count(*) count, sysdate st from "swt_rpt_stg"."SF_Apttus__APTS_Agreement__c";
/* Inserting values into Audit table  */

INSERT INTO swt_rpt_stg.FAST_LD_AUDT
(
SUBJECT_AREA
,TBL_NM
,LD_DT
,START_DT_TIME
,END_DT_TIME
,SRC_REC_CNT
,TGT_REC_CNT
,COMPLTN_STAT
)
select 'SFDC','SF_Apttus__APTS_Agreement__c',sysdate::date,sysdate,null,(select count from Start_Time_Tmp) ,null,'N';

Commit;

CREATE LOCAL TEMP TABLE SF_Apttus__APTS_Agreement__c_stg_Tmp ON COMMIT PRESERVE ROWS AS
(
SELECT DISTINCT * FROM swt_rpt_stg.SF_Apttus__APTS_Agreement__c)
SEGMENTED BY HASH(ID,LastModifiedDate) ALL NODES;

INSERT /*+Direct*/ INTO swt_rpt_stg.SF_Apttus__APTS_Agreement__c_Hist SELECT * from swt_rpt_stg.SF_Apttus__APTS_Agreement__c;
COMMIT;
TRUNCATE TABLE swt_rpt_stg.SF_Apttus__APTS_Agreement__c;

CREATE LOCAL TEMP TABLE SF_Apttus__APTS_Agreement__c_base_Tmp ON COMMIT PRESERVE ROWS AS
(
SELECT DISTINCT ID,LastModifiedDate FROM swt_rpt_base.SF_Apttus__APTS_Agreement__c)
SEGMENTED BY HASH(ID,LastModifiedDate) ALL NODES;


CREATE LOCAL TEMP TABLE SF_Apttus__APTS_Agreement__c_stg_Tmp_Key ON COMMIT PRESERVE ROWS AS
(
SELECT id, max(LastModifiedDate) as LastModifiedDate FROM SF_Apttus__APTS_Agreement__c_stg_Tmp group by id)
SEGMENTED BY HASH(ID,LastModifiedDate) ALL NODES;



/* Inserting Stage table data into Historical Table */

insert /*+DIRECT*/ into swt_rpt_stg.SF_Apttus__APTS_Agreement__c_Hist
(
Name
,CreatedById
,CurrencyIsoCode
,LastModifiedById
,OwnerId
,RecordTypeId
,SWT_3P_Software_resale__c
,Apttus__Account__c
,Apttus__Account_Search_Field__c
,Apttus__FF_Execute__c
,Apttus__Activated_By__c
,Apttus__Activated_Date__c
,SWT_Agreement_Active__c
,SWT_Agreed_Delivery_Plan_on_PO__c
,SWT_Agreed_Payment_Terms_on_PO__c
,SWT_Agreed_Prod_Price_Quant_Disc_on_PO__c
,SWT_Agreed_Terms_Conditions_on_PO__c
,Apttus__Agreement_Category__c
,Apttus__Contract_End_Date__c
,SWT_Agreement_End_Date__c
,Apttus__FF_Agreement_Number__c
,Apttus__Contract_Number__c
,Apttus__Agreement_Number__c
,Apttus__Contract_Start_Date__c
,SWT_Agreement_Start_Date__c
,Apttus__AllowableOutputFormats__c
,Apttus__FF_Amend__c
,Apttus__Amendment_Effective_Date__c
,Apttus_Approval__Approval_Status__c
,SWT_Approved_currency_on_PO__c
,Apttus_CMConfig__AutoActivateOrder__c
,Apttus_CMConfig__AutoCreateBill__c
,Apttus_CMConfig__AutoCreateRevenue__c
,Apttus__Auto_Renewal__c
,SWT_Bid_Manager__c
,SWT_Bid_Manager_Email__c
,SWT_Billing_Plan__c
,Apttus_CMConfig__BillingPreferenceId__c
,Apttus_CMConfig__BillToAccountId__c
,SWT_Bill_To_Address__c
,Apttus__Business_Hours__c
,SWT_Business_Relationship_Category__c
,SWT_Line_of_Business__c
,SWT_Cancellation_Reason__c
,Apttus__FF_Cancel_Request__c
,SWT_CMT__c
,Apttus__Company_Signed_By__c
,Apttus__Company_Signed_Date__c
,Apttus__Company_Signed_Title__c
,Apttus_CMConfig__ConfigurationFinalizedDate__c
,Apttus_CMConfig__ConfigurationSyncDate__c
,Apttus_CMConfig__Configure__c
,Apttus__Contract_Duration_Days__c
,Apttus__Contracted_Days__c
,SWT_Contract_Terms__c
,SWT_Country__c
,VCP__c
,SWT_Deal_Reviewer__c
,SWT_Delivery_To__c
,SWT_Delivery_Type__c
,Apttus__Description__c
,SWT_Education_Service_Training_Net_Price__c
,SWT_EGM__c
,SWT_End_Customer__c
,Apttus__Executed_Copy_Mailed_Out_Date__c
,Apttus__FF_Expire__c
,SWT_External_Invoice_Memo__c
,SWT_Federal__c
,Apttus__FF_View_Final_Contract__c
,SWT_Generate__c
,Apttus__FF_Generate_Protected_Agreement__c
,Apttus__FF_Generate_Supporting_Document__c
,Apttus__FF_Generate_Unprotected_Agreement__c
,GTS_Check_Passed__c
,SWT_GTS_passed_for_End_Customer_Account__c
,SWT_GTS_passed_for_Sold_To_Account__c
,SWT_HPE_Legal_Entity__c
,Apttus__Import_Offline_Document__c
,Apttus__InitiateTermination__c
,Apttus__Initiation_Type__c
,SWT_Internal_Memo__c
,Apttus__Internal_Renewal_Notification_Days__c
,Apttus__Internal_Renewal_Start_Date__c
,Apttus__IsInternalReview__c
,Apttus__IsLocked__c
,Apttus__Is_System_Update__c
,Apttus__Workflow_Trigger_Created_From_Clone__c
,Apttus__LatestDocId__c
,SWT_LOC__c
,SWT_License_Sale_Involved__c
,Apttus_Approval__LineItem_Approval_Status__c
,Apttus_CMConfig__LocationId__c
,SWT_Market_Offering__c
,SWT_Membership_Level__c
,Apttus__Non_Standard_Legal_Language__c
,SWT_Non_Standard_Ts_Cs_approval_required__c
,SWT_oldOppId__c
,SWT_Open_Air_Project_ID__c
,SWT_Generate_Order__c
,Order_Acceptance_Criteria_Passed__c
,SWT_Order_Booking_Owner__c
,SWT_Order_Booking_Queue__c
,SWT_Order_Internal_Id__c
,Apttus__Other_Party_Returned_Date__c
,Apttus__Other_Party_Sent_Date__c
,Apttus__Other_Party_Signed_By__c
,Apttus__Other_Party_Signed_By_Unlisted__c
,Apttus__Other_Party_Signed_Date__c
,Apttus__Other_Party_Signed_Title__c
,Apttus__Outstanding_Days__c
,SWT_Overall_Membership_Level__c
,Apttus__Owner_Expiration_Notice__c
,SWT_Packaged_Service_Net_Price__c
,Apttus__Parent_Agreement__c
,SWT_Partner_Account__c
,Apttus_CMConfig__PaymentTermId__c
,Apttus_CMConfig__PayoutFrequency__c
,Apttus__Perpetual__c
,SWT_PO_Attached__c
,Apttus_CMConfig__PODate__c
,SWT_PO_information_fully_complete__c
,Apttus_CMConfig__PONumber__c
,SWT_PO_Required__c
,SWT_PO_Exempt__c
,SWT_POA__c
,SWT_PO_Exempt_Details__c
,Apttus__FF_View_Draft_Contract__c
,SWT_Preview__c
,Apttus_CMConfig__PriceListId__c
,Apttus_CMConfig__PricingDate__c
,Apttus__Primary_Contact__c
,SWT_Product_Line__c
,SWT_Project_Duration__c
,SWT_Project_ID__c
,SWT_Project_Name__c
,SWT_PS_Sales_Representative__c
,Apttus_CMConfig__ReadyForActivationDate__c
,Apttus_CMConfig__ReadyForBillingDate__c
,Apttus_CMConfig__ReadyForFulfillmentDate__c
,Apttus_CMConfig__ReadyForRevRecDate__c
,Apttus__FF_Regenerate_Agreement__c
,SWT_Region__c
,Apttus__Related_Opportunity__c
,Apttus_QPComply__RelatedProposalId__c
,SWT_Re_Levelling_Date__c
,Apttus__Remaining_Contracted_Days__c
,Apttus__FF_Renew__c
,Apttus__Auto_Renew_Consent__c
,Apttus__Renewal_Notice_Date__c
,Apttus__Renewal_Notice_Days__c
,Apttus__Auto_Renew_Term_Months__c
,Apttus__Auto_Renewal_Terms__c
,Apttus__Request_Date__c
,Apttus__Requestor__c
,Apttus__RetentionDate__c
,Apttus__RetentionPolicyId__c
,Apttus__FF_Return_To_Requestor__c
,SWT_Revenue_Recognition_Method__c
,Apttus__Risk_Rating__c
,SWT_Risk_Rating__c
,SWT_RRC_required__c
,SWT_Sales_Rep_Email__c
,SWT_Send_for_E_Sign__c
,Apttus_Echosign__Send_For_eSignature__c
,Apttus__FF_Send_To_Other_Party_For_Review__c
,Apttus__FF_Send_To_Other_Party_For_Signatures__c
,SWT_Send_To_Customer__c
,Apttus__FF_Send_To_Third_Party__c
,Apttus_CMConfig__ShipToAccountId__c
,SWT_Solution_Architect__c
,Apttus__Source__c
,SWT_Specialization_Start_Date__c
,Apttus__Special_Terms__c
,Apttus__Status__c
,Apttus__Status_Category__c
,SWT_Submit_For_Approval__c
,Apttus__FF_Submit_For_Changes__c
,Apttus__FF_Submit_Request__c
,Apttus__Submit_Request_Mode__c
,SWT_Sub_Product_Line__c
,Apttus__Subtype__c
,Apttus_CMConfig__SyncWithOpportunity__c
,SWT_Synchronize_With_Opportunity__c
,SWT_Tax_status_established__c
,Apttus__Term_Months__c
,Apttus_Approval__Term_Exception_Approval_Status__c
,Apttus__FF_Terminate__c
,Apttus__TerminationComments__c
,Apttus__Termination_Date__c
,Apttus__Termination_Notice_Days__c
,Apttus__Termination_Notice_Issue_Date__c
,Third_Party__c
,SWT_Tier_1_Partner__c
,SWT_Tier_1_Partner_Relationship__c
,SWT_Tier_2_Partner__c
,SWT_Tier_2_Partner_Relationship__c
,Apttus__Total_Contract_Value__c
,SWT_Total_Consulting_Price__c
,SWT_Total_Consulting_Resource_Net_Pr__c
,SWT_Total_Contract_Value__c
,SWT_Total_Education_Price__c
,SWT_Total_Package_Price__c
,SWT_Total_Travel_Expense_Price__c
,SWT_Travel_Expense_Net_Price_del__c
,SWT_Valid_Agreement_ID_on_PO__c
,SWT_Valid_Ship_To_Address_on_PO__c
,SWT_Valid_Sold_To_Address_on_PO__c
,Apttus__Version__c
,Apttus__VersionAware__c
,Apttus__Version_Number__c
,SWT_VSOE_approval_required__c
,SWT_Wet_Signature_Received__c
,Apttus__Workflow_Trigger_Viewed_Final__c
,Id
,LastModifiedDate
,SWT_Third_Party_Anti_Corruption_Check__c
,SWT_Credit_Check_Failure_Reason__c
,SWT_End_Customer_Address__c
,SWT_Booked_Engagement_Margin__c
,SWT_Segment_Offering__c
,SWT_Total_Net_Amount__c
,SWT_Additional_Terms__c
,SWT_Agreement_Modifications__c
,SWT_Portfolio_Terms__c
,SWT_Warranty_Period__c
,SWT_In_Effect_CheckBox__c
,SWT_Approval_Checklist_Reviewed__c
,SWT_InternalId__c
,SWT_NetSuite_Project_ID__c
,SWT_DWO_Project_ID__c
,SWT_Delivery_Without_Approval__c
,SWT_Purchase_Terms__c
,SWT_Evergreen_Indicator__c
,SWT_Sold_to_Address__c
,SWT_Country_Executed__c
,SWT_Revision_Number__c
,SWT_Geographical_Scope__c
,SWT_Sell_To_Countries__c
,SWT_Unique_Key__c
,SWT_Influencer__c
,SWT_End_Customer_Contact__c
,SWT_PARTNER_Submit_For_Approval__c
,SWT_My_Approval__c
,SWT_Type__c
,SWT_Contract_Type__c
,SWT_Deal_Requester__c
,SWT_GTS_Check_Failure_Reason__c
,SWT_Subsidiary__c
,SWT_Third_party_services__c
,SWT_BillingPlanPS__c
,SWT_Negative_Change_Order_reason__c
,SWT_Negative_Change_Order_Doc_Attached__c
,SWT_Negative_Change_Order_Amount__c
,SWT_Negative_Change_Order__c
,SWT_Completion_Date_3rd_Party__c
,SWT_3_Party_Anti_Corruption_Check_Comp__c
,SWT_Blended_Rates_Approval_Required__c
,Legal_Team_Member__c
,SWT_Amended_Aggrement_TCV__c
,SWT_New_Total_Contract_Value__c
,SWT_OpportunityID__c
,SWT_Sync_To_Opportunity__c
,SWT_Terms__c
,SWT_Total_Contract_Value_ESD__c
,SWT_Watch_List__c
,SWT_Related_Quote__c
,SWT_Primary_Contact_Email__c
,SWT_Agreement_Type__c
,SWT_Single_Source_Distributor__c
,SWT_License_Representative__c
,SWT_DistributoronBehalfOf__c
,SWT_Distributor_on_Behalf__c
,SWT_ProjectStartDate__c
,SWT_Subsidiary_Address__c
,SWT_Created_From__c
,SWT_Will_agreement_be_in_English__c
,SWT_Miscellaneous_Account__c
,SWT_Program_Membership_level__c
,SWT_Billing_Contact__c
,SWT_Partner_Account_Address__c
,SWT_Approved_Presales_Budget__c
,SWT_Contains_Personal_Information_Data__c
,SWT_Deal_Desk_Coordinator__c
,SWT_SOW_Deadline__c
,SWT_OLD_EGM__c
,SWT_Opinion__c
,SWT_Miscellaneous_agreements_loaded__c
,SWT_Old_Quote_ID__c
,SWT_Old_Parent_Agreement_Id__c
,SWT_OEM_Agreement_Number__c
,SWT_Is_SOW__c
,SWT_ELA_Agreement_Number__c
,SWT_Account_Service_Provider_Agreement__c
,SWT_Types__c
,SWT_PO_Amount__c
,SWT_Is_Quote_Agreement__c
,SWT_Is_Account_Agreement__c
,SWT_Display_License_Type_UoM_on_Exhibit__c
,SWT_Disp_Non_Prod_Class_on_Exhibit__c
,SWT_DispRoyalty_Bearing_or_Fixed_Quantit__c
,SWT_Display_Net_Price_on_Exhibit__c
,SWT_Display_List_Price_on_Exhibit__c
,SWT_Display_Per_Unit_Net_License_Fee__c
,SWT_Quote_Type__c
,SWT_In_Organic_Growth_Clause__c
,SWT_Organic_Growth_Clause__c
,SWT_Reallocation_Clause__c
,SWT_Termination_for_Convenience_Clause__c
,SWT_Termination_for_Performance_Clause__c
,SWT_RecordType__c
,IsDeleted
,CreatedDate
,SystemModstamp
,LastActivityDate
,LastViewedDate
,LastReferencedDate
,SWT_Currency__c
,SWT_Annual_Contract_Value_ACV__c
,Apttus_CMConfig__ABOType__c
,Apttus_CMConfig__IsSystemGenerated__c
,Apttus_CMConfig__SyncAssetChangesToAgreement__c
,SWT_Audit_Compliance_Clause_CheckBox__c
,SWT_Audit_Compliance_Clause__c
,SWT_Committed_Contract_Value_CCV__c
,SWT_In_Organic_Growth_Clause_cbk__c
,SWT_Organic_Growth_Clause_cbk__c
,SWT_Reallocation_Clause_cbk__c
,SWT_Termination_for_Conv_Clause_cbk__c
,SWT_Termination_for_Perform_Clause_cbk__c
,SWT_Total_Contract_Value_TCV__c
,SWT_Committed_Contract_Months__c
,SWT_Primary_Contact__c
,SWT_New_TCV_USD_For_Approval__c
,SWT_TCV_USD_Value__c
,On_Hold_Reason__c
,SWT_Country_DSE_code__C
,SWT_Send_to_Customer_on_paper_Act_Agmt__c
,SWT_On_Hold_Reason__c
,LD_DT
,SWT_INS_DT
,d_source
)
select
Name
,CreatedById
,CurrencyIsoCode
,LastModifiedById
,OwnerId
,RecordTypeId
,SWT_3P_Software_resale__c
,Apttus__Account__c
,Apttus__Account_Search_Field__c
,Apttus__FF_Execute__c
,Apttus__Activated_By__c
,Apttus__Activated_Date__c
,SWT_Agreement_Active__c
,SWT_Agreed_Delivery_Plan_on_PO__c
,SWT_Agreed_Payment_Terms_on_PO__c
,SWT_Agreed_Prod_Price_Quant_Disc_on_PO__c
,SWT_Agreed_Terms_Conditions_on_PO__c
,Apttus__Agreement_Category__c
,Apttus__Contract_End_Date__c
,SWT_Agreement_End_Date__c
,Apttus__FF_Agreement_Number__c
,Apttus__Contract_Number__c
,Apttus__Agreement_Number__c
,Apttus__Contract_Start_Date__c
,SWT_Agreement_Start_Date__c
,Apttus__AllowableOutputFormats__c
,Apttus__FF_Amend__c
,Apttus__Amendment_Effective_Date__c
,Apttus_Approval__Approval_Status__c
,SWT_Approved_currency_on_PO__c
,Apttus_CMConfig__AutoActivateOrder__c
,Apttus_CMConfig__AutoCreateBill__c
,Apttus_CMConfig__AutoCreateRevenue__c
,Apttus__Auto_Renewal__c
,SWT_Bid_Manager__c
,SWT_Bid_Manager_Email__c
,SWT_Billing_Plan__c
,Apttus_CMConfig__BillingPreferenceId__c
,Apttus_CMConfig__BillToAccountId__c
,SWT_Bill_To_Address__c
,Apttus__Business_Hours__c
,SWT_Business_Relationship_Category__c
,SWT_Line_of_Business__c
,SWT_Cancellation_Reason__c
,Apttus__FF_Cancel_Request__c
,SWT_CMT__c
,Apttus__Company_Signed_By__c
,Apttus__Company_Signed_Date__c
,Apttus__Company_Signed_Title__c
,Apttus_CMConfig__ConfigurationFinalizedDate__c
,Apttus_CMConfig__ConfigurationSyncDate__c
,Apttus_CMConfig__Configure__c
,Apttus__Contract_Duration_Days__c
,Apttus__Contracted_Days__c
,SWT_Contract_Terms__c
,SWT_Country__c
,VCP__c
,SWT_Deal_Reviewer__c
,SWT_Delivery_To__c
,SWT_Delivery_Type__c
,Apttus__Description__c
,SWT_Education_Service_Training_Net_Price__c
,SWT_EGM__c
,SWT_End_Customer__c
,Apttus__Executed_Copy_Mailed_Out_Date__c
,Apttus__FF_Expire__c
,SWT_External_Invoice_Memo__c
,SWT_Federal__c
,Apttus__FF_View_Final_Contract__c
,SWT_Generate__c
,Apttus__FF_Generate_Protected_Agreement__c
,Apttus__FF_Generate_Supporting_Document__c
,Apttus__FF_Generate_Unprotected_Agreement__c
,GTS_Check_Passed__c
,SWT_GTS_passed_for_End_Customer_Account__c
,SWT_GTS_passed_for_Sold_To_Account__c
,SWT_HPE_Legal_Entity__c
,Apttus__Import_Offline_Document__c
,Apttus__InitiateTermination__c
,Apttus__Initiation_Type__c
,SWT_Internal_Memo__c
,Apttus__Internal_Renewal_Notification_Days__c
,Apttus__Internal_Renewal_Start_Date__c
,Apttus__IsInternalReview__c
,Apttus__IsLocked__c
,Apttus__Is_System_Update__c
,Apttus__Workflow_Trigger_Created_From_Clone__c
,Apttus__LatestDocId__c
,SWT_LOC__c
,SWT_License_Sale_Involved__c
,Apttus_Approval__LineItem_Approval_Status__c
,Apttus_CMConfig__LocationId__c
,SWT_Market_Offering__c
,SWT_Membership_Level__c
,Apttus__Non_Standard_Legal_Language__c
,SWT_Non_Standard_Ts_Cs_approval_required__c
,SWT_oldOppId__c
,SWT_Open_Air_Project_ID__c
,SWT_Generate_Order__c
,Order_Acceptance_Criteria_Passed__c
,SWT_Order_Booking_Owner__c
,SWT_Order_Booking_Queue__c
,SWT_Order_Internal_Id__c
,Apttus__Other_Party_Returned_Date__c
,Apttus__Other_Party_Sent_Date__c
,Apttus__Other_Party_Signed_By__c
,Apttus__Other_Party_Signed_By_Unlisted__c
,Apttus__Other_Party_Signed_Date__c
,Apttus__Other_Party_Signed_Title__c
,Apttus__Outstanding_Days__c
,SWT_Overall_Membership_Level__c
,Apttus__Owner_Expiration_Notice__c
,SWT_Packaged_Service_Net_Price__c
,Apttus__Parent_Agreement__c
,SWT_Partner_Account__c
,Apttus_CMConfig__PaymentTermId__c
,Apttus_CMConfig__PayoutFrequency__c
,Apttus__Perpetual__c
,SWT_PO_Attached__c
,Apttus_CMConfig__PODate__c
,SWT_PO_information_fully_complete__c
,Apttus_CMConfig__PONumber__c
,SWT_PO_Required__c
,SWT_PO_Exempt__c
,SWT_POA__c
,SWT_PO_Exempt_Details__c
,Apttus__FF_View_Draft_Contract__c
,SWT_Preview__c
,Apttus_CMConfig__PriceListId__c
,Apttus_CMConfig__PricingDate__c
,Apttus__Primary_Contact__c
,SWT_Product_Line__c
,SWT_Project_Duration__c
,SWT_Project_ID__c
,SWT_Project_Name__c
,SWT_PS_Sales_Representative__c
,Apttus_CMConfig__ReadyForActivationDate__c
,Apttus_CMConfig__ReadyForBillingDate__c
,Apttus_CMConfig__ReadyForFulfillmentDate__c
,Apttus_CMConfig__ReadyForRevRecDate__c
,Apttus__FF_Regenerate_Agreement__c
,SWT_Region__c
,Apttus__Related_Opportunity__c
,Apttus_QPComply__RelatedProposalId__c
,SWT_Re_Levelling_Date__c
,Apttus__Remaining_Contracted_Days__c
,Apttus__FF_Renew__c
,Apttus__Auto_Renew_Consent__c
,Apttus__Renewal_Notice_Date__c
,Apttus__Renewal_Notice_Days__c
,Apttus__Auto_Renew_Term_Months__c
,Apttus__Auto_Renewal_Terms__c
,Apttus__Request_Date__c
,Apttus__Requestor__c
,Apttus__RetentionDate__c
,Apttus__RetentionPolicyId__c
,Apttus__FF_Return_To_Requestor__c
,SWT_Revenue_Recognition_Method__c
,Apttus__Risk_Rating__c
,SWT_Risk_Rating__c
,SWT_RRC_required__c
,SWT_Sales_Rep_Email__c
,SWT_Send_for_E_Sign__c
,Apttus_Echosign__Send_For_eSignature__c
,Apttus__FF_Send_To_Other_Party_For_Review__c
,Apttus__FF_Send_To_Other_Party_For_Signatures__c
,SWT_Send_To_Customer__c
,Apttus__FF_Send_To_Third_Party__c
,Apttus_CMConfig__ShipToAccountId__c
,SWT_Solution_Architect__c
,Apttus__Source__c
,SWT_Specialization_Start_Date__c
,Apttus__Special_Terms__c
,Apttus__Status__c
,Apttus__Status_Category__c
,SWT_Submit_For_Approval__c
,Apttus__FF_Submit_For_Changes__c
,Apttus__FF_Submit_Request__c
,Apttus__Submit_Request_Mode__c
,SWT_Sub_Product_Line__c
,Apttus__Subtype__c
,Apttus_CMConfig__SyncWithOpportunity__c
,SWT_Synchronize_With_Opportunity__c
,SWT_Tax_status_established__c
,Apttus__Term_Months__c
,Apttus_Approval__Term_Exception_Approval_Status__c
,Apttus__FF_Terminate__c
,Apttus__TerminationComments__c
,Apttus__Termination_Date__c
,Apttus__Termination_Notice_Days__c
,Apttus__Termination_Notice_Issue_Date__c
,Third_Party__c
,SWT_Tier_1_Partner__c
,SWT_Tier_1_Partner_Relationship__c
,SWT_Tier_2_Partner__c
,SWT_Tier_2_Partner_Relationship__c
,Apttus__Total_Contract_Value__c
,SWT_Total_Consulting_Price__c
,SWT_Total_Consulting_Resource_Net_Pr__c
,SWT_Total_Contract_Value__c
,SWT_Total_Education_Price__c
,SWT_Total_Package_Price__c
,SWT_Total_Travel_Expense_Price__c
,SWT_Travel_Expense_Net_Price_del__c
,SWT_Valid_Agreement_ID_on_PO__c
,SWT_Valid_Ship_To_Address_on_PO__c
,SWT_Valid_Sold_To_Address_on_PO__c
,Apttus__Version__c
,Apttus__VersionAware__c
,Apttus__Version_Number__c
,SWT_VSOE_approval_required__c
,SWT_Wet_Signature_Received__c
,Apttus__Workflow_Trigger_Viewed_Final__c
,Id
,LastModifiedDate
,SWT_Third_Party_Anti_Corruption_Check__c
,SWT_Credit_Check_Failure_Reason__c
,SWT_End_Customer_Address__c
,SWT_Booked_Engagement_Margin__c
,SWT_Segment_Offering__c
,SWT_Total_Net_Amount__c
,SWT_Additional_Terms__c
,SWT_Agreement_Modifications__c
,SWT_Portfolio_Terms__c
,SWT_Warranty_Period__c
,SWT_In_Effect_CheckBox__c
,SWT_Approval_Checklist_Reviewed__c
,SWT_InternalId__c
,SWT_NetSuite_Project_ID__c
,SWT_DWO_Project_ID__c
,SWT_Delivery_Without_Approval__c
,SWT_Purchase_Terms__c
,SWT_Evergreen_Indicator__c
,SWT_Sold_to_Address__c
,SWT_Country_Executed__c
,SWT_Revision_Number__c
,SWT_Geographical_Scope__c
,SWT_Sell_To_Countries__c
,SWT_Unique_Key__c
,SWT_Influencer__c
,SWT_End_Customer_Contact__c
,SWT_PARTNER_Submit_For_Approval__c
,SWT_My_Approval__c
,SWT_Type__c
,SWT_Contract_Type__c
,SWT_Deal_Requester__c
,SWT_GTS_Check_Failure_Reason__c
,SWT_Subsidiary__c
,SWT_Third_party_services__c
,SWT_BillingPlanPS__c
,SWT_Negative_Change_Order_reason__c
,SWT_Negative_Change_Order_Doc_Attached__c
,SWT_Negative_Change_Order_Amount__c
,SWT_Negative_Change_Order__c
,SWT_Completion_Date_3rd_Party__c
,SWT_3_Party_Anti_Corruption_Check_Comp__c
,SWT_Blended_Rates_Approval_Required__c
,Legal_Team_Member__c
,SWT_Amended_Aggrement_TCV__c
,SWT_New_Total_Contract_Value__c
,SWT_OpportunityID__c
,SWT_Sync_To_Opportunity__c
,SWT_Terms__c
,SWT_Total_Contract_Value_ESD__c
,SWT_Watch_List__c
,SWT_Related_Quote__c
,SWT_Primary_Contact_Email__c
,SWT_Agreement_Type__c
,SWT_Single_Source_Distributor__c
,SWT_License_Representative__c
,SWT_DistributoronBehalfOf__c
,SWT_Distributor_on_Behalf__c
,SWT_ProjectStartDate__c
,SWT_Subsidiary_Address__c
,SWT_Created_From__c
,SWT_Will_agreement_be_in_English__c
,SWT_Miscellaneous_Account__c
,SWT_Program_Membership_level__c
,SWT_Billing_Contact__c
,SWT_Partner_Account_Address__c
,SWT_Approved_Presales_Budget__c
,SWT_Contains_Personal_Information_Data__c
,SWT_Deal_Desk_Coordinator__c
,SWT_SOW_Deadline__c
,SWT_OLD_EGM__c
,SWT_Opinion__c
,SWT_Miscellaneous_agreements_loaded__c
,SWT_Old_Quote_ID__c
,SWT_Old_Parent_Agreement_Id__c
,SWT_OEM_Agreement_Number__c
,SWT_Is_SOW__c
,SWT_ELA_Agreement_Number__c
,SWT_Account_Service_Provider_Agreement__c
,SWT_Types__c
,SWT_PO_Amount__c
,SWT_Is_Quote_Agreement__c
,SWT_Is_Account_Agreement__c
,SWT_Display_License_Type_UoM_on_Exhibit__c
,SWT_Disp_Non_Prod_Class_on_Exhibit__c
,SWT_DispRoyalty_Bearing_or_Fixed_Quantit__c
,SWT_Display_Net_Price_on_Exhibit__c
,SWT_Display_List_Price_on_Exhibit__c
,SWT_Display_Per_Unit_Net_License_Fee__c
,SWT_Quote_Type__c
,SWT_In_Organic_Growth_Clause__c
,SWT_Organic_Growth_Clause__c
,SWT_Reallocation_Clause__c
,SWT_Termination_for_Convenience_Clause__c
,SWT_Termination_for_Performance_Clause__c
,SWT_RecordType__c
,IsDeleted
,CreatedDate
,SystemModstamp
,LastActivityDate
,LastViewedDate
,LastReferencedDate
,SWT_Currency__c
,SWT_Annual_Contract_Value_ACV__c
,Apttus_CMConfig__ABOType__c
,Apttus_CMConfig__IsSystemGenerated__c
,Apttus_CMConfig__SyncAssetChangesToAgreement__c
,SWT_Audit_Compliance_Clause_CheckBox__c
,SWT_Audit_Compliance_Clause__c
,SWT_Committed_Contract_Value_CCV__c
,SWT_In_Organic_Growth_Clause_cbk__c
,SWT_Organic_Growth_Clause_cbk__c
,SWT_Reallocation_Clause_cbk__c
,SWT_Termination_for_Conv_Clause_cbk__c
,SWT_Termination_for_Perform_Clause_cbk__c
,SWT_Total_Contract_Value_TCV__c
,SWT_Committed_Contract_Months__c
,SWT_Primary_Contact__c
,SWT_New_TCV_USD_For_Approval__c
,SWT_TCV_USD_Value__c
,On_Hold_Reason__c
,SWT_Country_DSE_code__C
,SWT_Send_to_Customer_on_paper_Act_Agmt__c
,SWT_On_Hold_Reason__c
,SYSDATE AS LD_DT
,SWT_INS_DT
,'base'
FROM "swt_rpt_base".SF_Apttus__APTS_Agreement__c WHERE id in
(SELECT STG.id FROM SF_Apttus__APTS_Agreement__c_stg_Tmp_Key STG JOIN SF_Apttus__APTS_Agreement__c_base_Tmp
ON STG.id = SF_Apttus__APTS_Agreement__c_base_Tmp.id AND STG.LastModifiedDate >= SF_Apttus__APTS_Agreement__c_base_Tmp.LastModifiedDate);



/* Deleting before seven days data from current date in the Historical Table */

delete /*+DIRECT*/ from "swt_rpt_stg"."SF_Apttus__APTS_Agreement__c_HIST"  where LD_DT::date <= TIMESTAMPADD(DAY,-7,sysdate)::date;





/* Incremental VSQL script for loading data from Stage to Base */

DELETE /*+DIRECT*/ FROM "swt_rpt_base".SF_Apttus__APTS_Agreement__c WHERE id in 
(SELECT STG.id FROM SF_Apttus__APTS_Agreement__c_stg_Tmp_Key STG JOIN SF_Apttus__APTS_Agreement__c_base_Tmp
ON STG.id = SF_Apttus__APTS_Agreement__c_base_Tmp.id AND STG.LastModifiedDate >= SF_Apttus__APTS_Agreement__c_base_Tmp.LastModifiedDate);

INSERT /*+DIRECT*/ INTO "swt_rpt_base".SF_Apttus__APTS_Agreement__c
(
Name
,CreatedById
,CurrencyIsoCode
,LastModifiedById
,OwnerId
,RecordTypeId
,SWT_3P_Software_resale__c
,Apttus__Account__c
,Apttus__Account_Search_Field__c
,Apttus__FF_Execute__c
,Apttus__Activated_By__c
,Apttus__Activated_Date__c
,SWT_Agreement_Active__c
,SWT_Agreed_Delivery_Plan_on_PO__c
,SWT_Agreed_Payment_Terms_on_PO__c
,SWT_Agreed_Prod_Price_Quant_Disc_on_PO__c
,SWT_Agreed_Terms_Conditions_on_PO__c
,Apttus__Agreement_Category__c
,Apttus__Contract_End_Date__c
,SWT_Agreement_End_Date__c
,Apttus__FF_Agreement_Number__c
,Apttus__Contract_Number__c
,Apttus__Agreement_Number__c
,Apttus__Contract_Start_Date__c
,SWT_Agreement_Start_Date__c
,Apttus__AllowableOutputFormats__c
,Apttus__FF_Amend__c
,Apttus__Amendment_Effective_Date__c
,Apttus_Approval__Approval_Status__c
,SWT_Approved_currency_on_PO__c
,Apttus_CMConfig__AutoActivateOrder__c
,Apttus_CMConfig__AutoCreateBill__c
,Apttus_CMConfig__AutoCreateRevenue__c
,Apttus__Auto_Renewal__c
,SWT_Bid_Manager__c
,SWT_Bid_Manager_Email__c
,SWT_Billing_Plan__c
,Apttus_CMConfig__BillingPreferenceId__c
,Apttus_CMConfig__BillToAccountId__c
,SWT_Bill_To_Address__c
,Apttus__Business_Hours__c
,SWT_Business_Relationship_Category__c
,SWT_Line_of_Business__c
,SWT_Cancellation_Reason__c
,Apttus__FF_Cancel_Request__c
,SWT_CMT__c
,Apttus__Company_Signed_By__c
,Apttus__Company_Signed_Date__c
,Apttus__Company_Signed_Title__c
,Apttus_CMConfig__ConfigurationFinalizedDate__c
,Apttus_CMConfig__ConfigurationSyncDate__c
,Apttus_CMConfig__Configure__c
,Apttus__Contract_Duration_Days__c
,Apttus__Contracted_Days__c
,SWT_Contract_Terms__c
,SWT_Country__c
,VCP__c
,SWT_Deal_Reviewer__c
,SWT_Delivery_To__c
,SWT_Delivery_Type__c
,Apttus__Description__c
,SWT_Education_Service_Training_Net_Price__c
,SWT_EGM__c
,SWT_End_Customer__c
,Apttus__Executed_Copy_Mailed_Out_Date__c
,Apttus__FF_Expire__c
,SWT_External_Invoice_Memo__c
,SWT_Federal__c
,Apttus__FF_View_Final_Contract__c
,SWT_Generate__c
,Apttus__FF_Generate_Protected_Agreement__c
,Apttus__FF_Generate_Supporting_Document__c
,Apttus__FF_Generate_Unprotected_Agreement__c
,GTS_Check_Passed__c
,SWT_GTS_passed_for_End_Customer_Account__c
,SWT_GTS_passed_for_Sold_To_Account__c
,SWT_HPE_Legal_Entity__c
,Apttus__Import_Offline_Document__c
,Apttus__InitiateTermination__c
,Apttus__Initiation_Type__c
,SWT_Internal_Memo__c
,Apttus__Internal_Renewal_Notification_Days__c
,Apttus__Internal_Renewal_Start_Date__c
,Apttus__IsInternalReview__c
,Apttus__IsLocked__c
,Apttus__Is_System_Update__c
,Apttus__Workflow_Trigger_Created_From_Clone__c
,Apttus__LatestDocId__c
,SWT_LOC__c
,SWT_License_Sale_Involved__c
,Apttus_Approval__LineItem_Approval_Status__c
,Apttus_CMConfig__LocationId__c
,SWT_Market_Offering__c
,SWT_Membership_Level__c
,Apttus__Non_Standard_Legal_Language__c
,SWT_Non_Standard_Ts_Cs_approval_required__c
,SWT_oldOppId__c
,SWT_Open_Air_Project_ID__c
,SWT_Generate_Order__c
,Order_Acceptance_Criteria_Passed__c
,SWT_Order_Booking_Owner__c
,SWT_Order_Booking_Queue__c
,SWT_Order_Internal_Id__c
,Apttus__Other_Party_Returned_Date__c
,Apttus__Other_Party_Sent_Date__c
,Apttus__Other_Party_Signed_By__c
,Apttus__Other_Party_Signed_By_Unlisted__c
,Apttus__Other_Party_Signed_Date__c
,Apttus__Other_Party_Signed_Title__c
,Apttus__Outstanding_Days__c
,SWT_Overall_Membership_Level__c
,Apttus__Owner_Expiration_Notice__c
,SWT_Packaged_Service_Net_Price__c
,Apttus__Parent_Agreement__c
,SWT_Partner_Account__c
,Apttus_CMConfig__PaymentTermId__c
,Apttus_CMConfig__PayoutFrequency__c
,Apttus__Perpetual__c
,SWT_PO_Attached__c
,Apttus_CMConfig__PODate__c
,SWT_PO_information_fully_complete__c
,Apttus_CMConfig__PONumber__c
,SWT_PO_Required__c
,SWT_PO_Exempt__c
,SWT_POA__c
,SWT_PO_Exempt_Details__c
,Apttus__FF_View_Draft_Contract__c
,SWT_Preview__c
,Apttus_CMConfig__PriceListId__c
,Apttus_CMConfig__PricingDate__c
,Apttus__Primary_Contact__c
,SWT_Product_Line__c
,SWT_Project_Duration__c
,SWT_Project_ID__c
,SWT_Project_Name__c
,SWT_PS_Sales_Representative__c
,Apttus_CMConfig__ReadyForActivationDate__c
,Apttus_CMConfig__ReadyForBillingDate__c
,Apttus_CMConfig__ReadyForFulfillmentDate__c
,Apttus_CMConfig__ReadyForRevRecDate__c
,Apttus__FF_Regenerate_Agreement__c
,SWT_Region__c
,Apttus__Related_Opportunity__c
,Apttus_QPComply__RelatedProposalId__c
,SWT_Re_Levelling_Date__c
,Apttus__Remaining_Contracted_Days__c
,Apttus__FF_Renew__c
,Apttus__Auto_Renew_Consent__c
,Apttus__Renewal_Notice_Date__c
,Apttus__Renewal_Notice_Days__c
,Apttus__Auto_Renew_Term_Months__c
,Apttus__Auto_Renewal_Terms__c
,Apttus__Request_Date__c
,Apttus__Requestor__c
,Apttus__RetentionDate__c
,Apttus__RetentionPolicyId__c
,Apttus__FF_Return_To_Requestor__c
,SWT_Revenue_Recognition_Method__c
,Apttus__Risk_Rating__c
,SWT_Risk_Rating__c
,SWT_RRC_required__c
,SWT_Sales_Rep_Email__c
,SWT_Send_for_E_Sign__c
,Apttus_Echosign__Send_For_eSignature__c
,Apttus__FF_Send_To_Other_Party_For_Review__c
,Apttus__FF_Send_To_Other_Party_For_Signatures__c
,SWT_Send_To_Customer__c
,Apttus__FF_Send_To_Third_Party__c
,Apttus_CMConfig__ShipToAccountId__c
,SWT_Solution_Architect__c
,Apttus__Source__c
,SWT_Specialization_Start_Date__c
,Apttus__Special_Terms__c
,Apttus__Status__c
,Apttus__Status_Category__c
,SWT_Submit_For_Approval__c
,Apttus__FF_Submit_For_Changes__c
,Apttus__FF_Submit_Request__c
,Apttus__Submit_Request_Mode__c
,SWT_Sub_Product_Line__c
,Apttus__Subtype__c
,Apttus_CMConfig__SyncWithOpportunity__c
,SWT_Synchronize_With_Opportunity__c
,SWT_Tax_status_established__c
,Apttus__Term_Months__c
,Apttus_Approval__Term_Exception_Approval_Status__c
,Apttus__FF_Terminate__c
,Apttus__TerminationComments__c
,Apttus__Termination_Date__c
,Apttus__Termination_Notice_Days__c
,Apttus__Termination_Notice_Issue_Date__c
,Third_Party__c
,SWT_Tier_1_Partner__c
,SWT_Tier_1_Partner_Relationship__c
,SWT_Tier_2_Partner__c
,SWT_Tier_2_Partner_Relationship__c
,Apttus__Total_Contract_Value__c
,SWT_Total_Consulting_Price__c
,SWT_Total_Consulting_Resource_Net_Pr__c
,SWT_Total_Contract_Value__c
,SWT_Total_Education_Price__c
,SWT_Total_Package_Price__c
,SWT_Total_Travel_Expense_Price__c
,SWT_Travel_Expense_Net_Price_del__c
,SWT_Valid_Agreement_ID_on_PO__c
,SWT_Valid_Ship_To_Address_on_PO__c
,SWT_Valid_Sold_To_Address_on_PO__c
,Apttus__Version__c
,Apttus__VersionAware__c
,Apttus__Version_Number__c
,SWT_VSOE_approval_required__c
,SWT_Wet_Signature_Received__c
,Apttus__Workflow_Trigger_Viewed_Final__c
,Id
,LastModifiedDate
,SWT_Third_Party_Anti_Corruption_Check__c
,SWT_Credit_Check_Failure_Reason__c
,SWT_End_Customer_Address__c
,SWT_Booked_Engagement_Margin__c
,SWT_Segment_Offering__c
,SWT_Total_Net_Amount__c
,SWT_Additional_Terms__c
,SWT_Agreement_Modifications__c
,SWT_Portfolio_Terms__c
,SWT_Warranty_Period__c
,SWT_In_Effect_CheckBox__c
,SWT_Approval_Checklist_Reviewed__c
,SWT_InternalId__c
,SWT_NetSuite_Project_ID__c
,SWT_DWO_Project_ID__c
,SWT_Delivery_Without_Approval__c
,SWT_Purchase_Terms__c
,SWT_Evergreen_Indicator__c
,SWT_Sold_to_Address__c
,SWT_Country_Executed__c
,SWT_Revision_Number__c
,SWT_Geographical_Scope__c
,SWT_Sell_To_Countries__c
,SWT_Unique_Key__c
,SWT_Influencer__c
,SWT_End_Customer_Contact__c
,SWT_PARTNER_Submit_For_Approval__c
,SWT_My_Approval__c
,SWT_Type__c
,SWT_Contract_Type__c
,SWT_Deal_Requester__c
,SWT_GTS_Check_Failure_Reason__c
,SWT_Subsidiary__c
,SWT_Third_party_services__c
,SWT_BillingPlanPS__c
,SWT_Negative_Change_Order_reason__c
,SWT_Negative_Change_Order_Doc_Attached__c
,SWT_Negative_Change_Order_Amount__c
,SWT_Negative_Change_Order__c
,SWT_Completion_Date_3rd_Party__c
,SWT_3_Party_Anti_Corruption_Check_Comp__c
,SWT_Blended_Rates_Approval_Required__c
,Legal_Team_Member__c
,SWT_Amended_Aggrement_TCV__c
,SWT_New_Total_Contract_Value__c
,SWT_OpportunityID__c
,SWT_Sync_To_Opportunity__c
,SWT_Terms__c
,SWT_Total_Contract_Value_ESD__c
,SWT_Watch_List__c
,SWT_Related_Quote__c
,SWT_Primary_Contact_Email__c
,SWT_Agreement_Type__c
,SWT_Single_Source_Distributor__c
,SWT_License_Representative__c
,SWT_DistributoronBehalfOf__c
,SWT_Distributor_on_Behalf__c
,SWT_ProjectStartDate__c
,SWT_Subsidiary_Address__c
,SWT_Created_From__c
,SWT_Will_agreement_be_in_English__c
,SWT_Miscellaneous_Account__c
,SWT_Program_Membership_level__c
,SWT_Billing_Contact__c
,SWT_Partner_Account_Address__c
,SWT_Approved_Presales_Budget__c
,SWT_Contains_Personal_Information_Data__c
,SWT_Deal_Desk_Coordinator__c
,SWT_SOW_Deadline__c
,SWT_OLD_EGM__c
,SWT_Opinion__c
,SWT_Miscellaneous_agreements_loaded__c
,SWT_Old_Quote_ID__c
,SWT_Old_Parent_Agreement_Id__c
,SWT_OEM_Agreement_Number__c
,SWT_Is_SOW__c
,SWT_ELA_Agreement_Number__c
,SWT_Account_Service_Provider_Agreement__c
,SWT_Types__c
,SWT_PO_Amount__c
,SWT_Is_Quote_Agreement__c
,SWT_Is_Account_Agreement__c
,SWT_Display_License_Type_UoM_on_Exhibit__c
,SWT_Disp_Non_Prod_Class_on_Exhibit__c
,SWT_DispRoyalty_Bearing_or_Fixed_Quantit__c
,SWT_Display_Net_Price_on_Exhibit__c
,SWT_Display_List_Price_on_Exhibit__c
,SWT_Display_Per_Unit_Net_License_Fee__c
,SWT_Quote_Type__c
,SWT_In_Organic_Growth_Clause__c
,SWT_Organic_Growth_Clause__c
,SWT_Reallocation_Clause__c
,SWT_Termination_for_Convenience_Clause__c
,SWT_Termination_for_Performance_Clause__c
,SWT_RecordType__c
,IsDeleted
,CreatedDate
,SystemModstamp
,LastActivityDate
,LastViewedDate
,LastReferencedDate
,SWT_Currency__c
,SWT_Annual_Contract_Value_ACV__c
,Apttus_CMConfig__ABOType__c
,Apttus_CMConfig__IsSystemGenerated__c
,Apttus_CMConfig__SyncAssetChangesToAgreement__c
,SWT_Audit_Compliance_Clause_CheckBox__c
,SWT_Audit_Compliance_Clause__c
,SWT_Committed_Contract_Value_CCV__c
,SWT_In_Organic_Growth_Clause_cbk__c
,SWT_Organic_Growth_Clause_cbk__c
,SWT_Reallocation_Clause_cbk__c
,SWT_Termination_for_Conv_Clause_cbk__c
,SWT_Termination_for_Perform_Clause_cbk__c
,SWT_Total_Contract_Value_TCV__c
,SWT_Committed_Contract_Months__c
,SWT_Primary_Contact__c
,SWT_New_TCV_USD_For_Approval__c
,SWT_TCV_USD_Value__c
,On_Hold_Reason__c
,SWT_Country_DSE_code__C
,SWT_Send_to_Customer_on_paper_Act_Agmt__c
,SWT_On_Hold_Reason__c
,SWT_INS_DT
)
SELECT DISTINCT 
Name
,CreatedById
,CurrencyIsoCode
,LastModifiedById
,OwnerId
,RecordTypeId
,SWT_3P_Software_resale__c
,Apttus__Account__c
,Apttus__Account_Search_Field__c
,Apttus__FF_Execute__c
,Apttus__Activated_By__c
,Apttus__Activated_Date__c
,SWT_Agreement_Active__c
,SWT_Agreed_Delivery_Plan_on_PO__c
,SWT_Agreed_Payment_Terms_on_PO__c
,SWT_Agreed_Prod_Price_Quant_Disc_on_PO__c
,SWT_Agreed_Terms_Conditions_on_PO__c
,Apttus__Agreement_Category__c
,Apttus__Contract_End_Date__c
,SWT_Agreement_End_Date__c
,Apttus__FF_Agreement_Number__c
,Apttus__Contract_Number__c
,Apttus__Agreement_Number__c
,Apttus__Contract_Start_Date__c
,SWT_Agreement_Start_Date__c
,Apttus__AllowableOutputFormats__c
,Apttus__FF_Amend__c
,Apttus__Amendment_Effective_Date__c
,Apttus_Approval__Approval_Status__c
,SWT_Approved_currency_on_PO__c
,Apttus_CMConfig__AutoActivateOrder__c
,Apttus_CMConfig__AutoCreateBill__c
,Apttus_CMConfig__AutoCreateRevenue__c
,Apttus__Auto_Renewal__c
,SWT_Bid_Manager__c
,SWT_Bid_Manager_Email__c
,SWT_Billing_Plan__c
,Apttus_CMConfig__BillingPreferenceId__c
,Apttus_CMConfig__BillToAccountId__c
,SWT_Bill_To_Address__c
,Apttus__Business_Hours__c
,SWT_Business_Relationship_Category__c
,SWT_Line_of_Business__c
,SWT_Cancellation_Reason__c
,Apttus__FF_Cancel_Request__c
,SWT_CMT__c
,Apttus__Company_Signed_By__c
,Apttus__Company_Signed_Date__c
,Apttus__Company_Signed_Title__c
,Apttus_CMConfig__ConfigurationFinalizedDate__c
,Apttus_CMConfig__ConfigurationSyncDate__c
,Apttus_CMConfig__Configure__c
,Apttus__Contract_Duration_Days__c
,Apttus__Contracted_Days__c
,SWT_Contract_Terms__c
,SWT_Country__c
,VCP__c
,SWT_Deal_Reviewer__c
,SWT_Delivery_To__c
,SWT_Delivery_Type__c
,Apttus__Description__c
,SWT_Education_Service_Training_Net_Price__c
,SWT_EGM__c
,SWT_End_Customer__c
,Apttus__Executed_Copy_Mailed_Out_Date__c
,Apttus__FF_Expire__c
,SWT_External_Invoice_Memo__c
,SWT_Federal__c
,Apttus__FF_View_Final_Contract__c
,SWT_Generate__c
,Apttus__FF_Generate_Protected_Agreement__c
,Apttus__FF_Generate_Supporting_Document__c
,Apttus__FF_Generate_Unprotected_Agreement__c
,GTS_Check_Passed__c
,SWT_GTS_passed_for_End_Customer_Account__c
,SWT_GTS_passed_for_Sold_To_Account__c
,SWT_HPE_Legal_Entity__c
,Apttus__Import_Offline_Document__c
,Apttus__InitiateTermination__c
,Apttus__Initiation_Type__c
,SWT_Internal_Memo__c
,Apttus__Internal_Renewal_Notification_Days__c
,Apttus__Internal_Renewal_Start_Date__c
,Apttus__IsInternalReview__c
,Apttus__IsLocked__c
,Apttus__Is_System_Update__c
,Apttus__Workflow_Trigger_Created_From_Clone__c
,Apttus__LatestDocId__c
,SWT_LOC__c
,SWT_License_Sale_Involved__c
,Apttus_Approval__LineItem_Approval_Status__c
,Apttus_CMConfig__LocationId__c
,SWT_Market_Offering__c
,SWT_Membership_Level__c
,Apttus__Non_Standard_Legal_Language__c
,SWT_Non_Standard_Ts_Cs_approval_required__c
,SWT_oldOppId__c
,SWT_Open_Air_Project_ID__c
,SWT_Generate_Order__c
,Order_Acceptance_Criteria_Passed__c
,SWT_Order_Booking_Owner__c
,SWT_Order_Booking_Queue__c
,SWT_Order_Internal_Id__c
,Apttus__Other_Party_Returned_Date__c
,Apttus__Other_Party_Sent_Date__c
,Apttus__Other_Party_Signed_By__c
,Apttus__Other_Party_Signed_By_Unlisted__c
,Apttus__Other_Party_Signed_Date__c
,Apttus__Other_Party_Signed_Title__c
,Apttus__Outstanding_Days__c
,SWT_Overall_Membership_Level__c
,Apttus__Owner_Expiration_Notice__c
,SWT_Packaged_Service_Net_Price__c
,Apttus__Parent_Agreement__c
,SWT_Partner_Account__c
,Apttus_CMConfig__PaymentTermId__c
,Apttus_CMConfig__PayoutFrequency__c
,Apttus__Perpetual__c
,SWT_PO_Attached__c
,Apttus_CMConfig__PODate__c
,SWT_PO_information_fully_complete__c
,Apttus_CMConfig__PONumber__c
,SWT_PO_Required__c
,SWT_PO_Exempt__c
,SWT_POA__c
,SWT_PO_Exempt_Details__c
,Apttus__FF_View_Draft_Contract__c
,SWT_Preview__c
,Apttus_CMConfig__PriceListId__c
,Apttus_CMConfig__PricingDate__c
,Apttus__Primary_Contact__c
,SWT_Product_Line__c
,SWT_Project_Duration__c
,SWT_Project_ID__c
,SWT_Project_Name__c
,SWT_PS_Sales_Representative__c
,Apttus_CMConfig__ReadyForActivationDate__c
,Apttus_CMConfig__ReadyForBillingDate__c
,Apttus_CMConfig__ReadyForFulfillmentDate__c
,Apttus_CMConfig__ReadyForRevRecDate__c
,Apttus__FF_Regenerate_Agreement__c
,SWT_Region__c
,Apttus__Related_Opportunity__c
,Apttus_QPComply__RelatedProposalId__c
,SWT_Re_Levelling_Date__c
,Apttus__Remaining_Contracted_Days__c
,Apttus__FF_Renew__c
,Apttus__Auto_Renew_Consent__c
,Apttus__Renewal_Notice_Date__c
,Apttus__Renewal_Notice_Days__c
,Apttus__Auto_Renew_Term_Months__c
,Apttus__Auto_Renewal_Terms__c
,Apttus__Request_Date__c
,Apttus__Requestor__c
,Apttus__RetentionDate__c
,Apttus__RetentionPolicyId__c
,Apttus__FF_Return_To_Requestor__c
,SWT_Revenue_Recognition_Method__c
,Apttus__Risk_Rating__c
,SWT_Risk_Rating__c
,SWT_RRC_required__c
,SWT_Sales_Rep_Email__c
,SWT_Send_for_E_Sign__c
,Apttus_Echosign__Send_For_eSignature__c
,Apttus__FF_Send_To_Other_Party_For_Review__c
,Apttus__FF_Send_To_Other_Party_For_Signatures__c
,SWT_Send_To_Customer__c
,Apttus__FF_Send_To_Third_Party__c
,Apttus_CMConfig__ShipToAccountId__c
,SWT_Solution_Architect__c
,Apttus__Source__c
,SWT_Specialization_Start_Date__c
,Apttus__Special_Terms__c
,Apttus__Status__c
,Apttus__Status_Category__c
,SWT_Submit_For_Approval__c
,Apttus__FF_Submit_For_Changes__c
,Apttus__FF_Submit_Request__c
,Apttus__Submit_Request_Mode__c
,SWT_Sub_Product_Line__c
,Apttus__Subtype__c
,Apttus_CMConfig__SyncWithOpportunity__c
,SWT_Synchronize_With_Opportunity__c
,SWT_Tax_status_established__c
,Apttus__Term_Months__c
,Apttus_Approval__Term_Exception_Approval_Status__c
,Apttus__FF_Terminate__c
,Apttus__TerminationComments__c
,Apttus__Termination_Date__c
,Apttus__Termination_Notice_Days__c
,Apttus__Termination_Notice_Issue_Date__c
,Third_Party__c
,SWT_Tier_1_Partner__c
,SWT_Tier_1_Partner_Relationship__c
,SWT_Tier_2_Partner__c
,SWT_Tier_2_Partner_Relationship__c
,Apttus__Total_Contract_Value__c
,SWT_Total_Consulting_Price__c
,SWT_Total_Consulting_Resource_Net_Pr__c
,SWT_Total_Contract_Value__c
,SWT_Total_Education_Price__c
,SWT_Total_Package_Price__c
,SWT_Total_Travel_Expense_Price__c
,SWT_Travel_Expense_Net_Price_del__c
,SWT_Valid_Agreement_ID_on_PO__c
,SWT_Valid_Ship_To_Address_on_PO__c
,SWT_Valid_Sold_To_Address_on_PO__c
,Apttus__Version__c
,Apttus__VersionAware__c
,Apttus__Version_Number__c
,SWT_VSOE_approval_required__c
,SWT_Wet_Signature_Received__c
,Apttus__Workflow_Trigger_Viewed_Final__c
,SF_Apttus__APTS_Agreement__c_stg_Tmp.Id
,SF_Apttus__APTS_Agreement__c_stg_Tmp.LastModifiedDate
,SWT_Third_Party_Anti_Corruption_Check__c
,SWT_Credit_Check_Failure_Reason__c
,SWT_End_Customer_Address__c
,SWT_Booked_Engagement_Margin__c
,SWT_Segment_Offering__c
,SWT_Total_Net_Amount__c
,SWT_Additional_Terms__c
,SWT_Agreement_Modifications__c
,SWT_Portfolio_Terms__c
,SWT_Warranty_Period__c
,SWT_In_Effect_CheckBox__c
,SWT_Approval_Checklist_Reviewed__c
,SWT_InternalId__c
,SWT_NetSuite_Project_ID__c
,SWT_DWO_Project_ID__c
,SWT_Delivery_Without_Approval__c
,SWT_Purchase_Terms__c
,SWT_Evergreen_Indicator__c
,SWT_Sold_to_Address__c
,SWT_Country_Executed__c
,SWT_Revision_Number__c
,SWT_Geographical_Scope__c
,SWT_Sell_To_Countries__c
,SWT_Unique_Key__c
,SWT_Influencer__c
,SWT_End_Customer_Contact__c
,SWT_PARTNER_Submit_For_Approval__c
,SWT_My_Approval__c
,SWT_Type__c
,SWT_Contract_Type__c
,SWT_Deal_Requester__c
,SWT_GTS_Check_Failure_Reason__c
,SWT_Subsidiary__c
,SWT_Third_party_services__c
,SWT_BillingPlanPS__c
,SWT_Negative_Change_Order_reason__c
,SWT_Negative_Change_Order_Doc_Attached__c
,SWT_Negative_Change_Order_Amount__c
,SWT_Negative_Change_Order__c
,SWT_Completion_Date_3rd_Party__c
,SWT_3_Party_Anti_Corruption_Check_Comp__c
,SWT_Blended_Rates_Approval_Required__c
,Legal_Team_Member__c
,SWT_Amended_Aggrement_TCV__c
,SWT_New_Total_Contract_Value__c
,SWT_OpportunityID__c
,SWT_Sync_To_Opportunity__c
,SWT_Terms__c
,SWT_Total_Contract_Value_ESD__c
,SWT_Watch_List__c
,SWT_Related_Quote__c
,SWT_Primary_Contact_Email__c
,SWT_Agreement_Type__c
,SWT_Single_Source_Distributor__c
,SWT_License_Representative__c
,SWT_DistributoronBehalfOf__c
,SWT_Distributor_on_Behalf__c
,SWT_ProjectStartDate__c
,SWT_Subsidiary_Address__c
,SWT_Created_From__c
,SWT_Will_agreement_be_in_English__c
,SWT_Miscellaneous_Account__c
,SWT_Program_Membership_level__c
,SWT_Billing_Contact__c
,SWT_Partner_Account_Address__c
,SWT_Approved_Presales_Budget__c
,SWT_Contains_Personal_Information_Data__c
,SWT_Deal_Desk_Coordinator__c
,SWT_SOW_Deadline__c
,SWT_OLD_EGM__c
,SWT_Opinion__c
,SWT_Miscellaneous_agreements_loaded__c
,SWT_Old_Quote_ID__c
,SWT_Old_Parent_Agreement_Id__c
,SWT_OEM_Agreement_Number__c
,SWT_Is_SOW__c
,SWT_ELA_Agreement_Number__c
,SWT_Account_Service_Provider_Agreement__c
,SWT_Types__c
,SWT_PO_Amount__c
,SWT_Is_Quote_Agreement__c
,SWT_Is_Account_Agreement__c
,SWT_Display_License_Type_UoM_on_Exhibit__c
,SWT_Disp_Non_Prod_Class_on_Exhibit__c
,SWT_DispRoyalty_Bearing_or_Fixed_Quantit__c
,SWT_Display_Net_Price_on_Exhibit__c
,SWT_Display_List_Price_on_Exhibit__c
,SWT_Display_Per_Unit_Net_License_Fee__c
,SWT_Quote_Type__c
,SWT_In_Organic_Growth_Clause__c
,SWT_Organic_Growth_Clause__c
,SWT_Reallocation_Clause__c
,SWT_Termination_for_Convenience_Clause__c
,SWT_Termination_for_Performance_Clause__c
,SWT_RecordType__c
,IsDeleted
,CreatedDate
,SystemModstamp
,LastActivityDate
,LastViewedDate
,LastReferencedDate
,SWT_Currency__c
,SWT_Annual_Contract_Value_ACV__c
,Apttus_CMConfig__ABOType__c
,Apttus_CMConfig__IsSystemGenerated__c
,Apttus_CMConfig__SyncAssetChangesToAgreement__c
,SWT_Audit_Compliance_Clause_CheckBox__c
,SWT_Audit_Compliance_Clause__c
,SWT_Committed_Contract_Value_CCV__c
,SWT_In_Organic_Growth_Clause_cbk__c
,SWT_Organic_Growth_Clause_cbk__c
,SWT_Reallocation_Clause_cbk__c
,SWT_Termination_for_Conv_Clause_cbk__c
,SWT_Termination_for_Perform_Clause_cbk__c
,SWT_Total_Contract_Value_TCV__c
,SWT_Committed_Contract_Months__c
,SWT_Primary_Contact__c
,SWT_New_TCV_USD_For_Approval__c
,SWT_TCV_USD_Value__c
,On_Hold_Reason__c
,SWT_Country_DSE_code__C
,SWT_Send_to_Customer_on_paper_Act_Agmt__c
,SWT_On_Hold_Reason__c
,SYSDATE AS SWT_INS_DT
FROM SF_Apttus__APTS_Agreement__c_stg_Tmp JOIN SF_Apttus__APTS_Agreement__c_stg_Tmp_Key ON SF_Apttus__APTS_Agreement__c_stg_Tmp.id= SF_Apttus__APTS_Agreement__c_stg_Tmp_Key.id AND SF_Apttus__APTS_Agreement__c_stg_Tmp.LastModifiedDate=SF_Apttus__APTS_Agreement__c_stg_Tmp_Key.LastModifiedDate
WHERE NOT EXISTS
(SELECT 1 from "swt_rpt_base".SF_Apttus__APTS_Agreement__c BASE
WHERE SF_Apttus__APTS_Agreement__c_stg_Tmp.id = BASE.id);


/* Deleting partial audit entry */

DELETE FROM swt_rpt_stg.FAST_LD_AUDT where SUBJECT_AREA = 'SFDC' and
TBL_NM = 'SF_Apttus__APTS_Agreement__c' and
COMPLTN_STAT = 'N' and
LD_DT=sysdate::date and 
SEQ_ID = (select max(SEQ_ID) from swt_rpt_stg.FAST_LD_AUDT where  SUBJECT_AREA = 'SFDC' and  TBL_NM = 'SF_Apttus__APTS_Agreement__c' and  COMPLTN_STAT = 'N');


/* Inserting new audit entry with all stats */

INSERT INTO swt_rpt_stg.FAST_LD_AUDT
(
SUBJECT_AREA
,TBL_NM
,LD_DT
,START_DT_TIME
,END_DT_TIME
,SRC_REC_CNT
,TGT_REC_CNT
,COMPLTN_STAT
)
select 'SFDC','SF_Apttus__APTS_Agreement__c',sysdate::date,(select st from Start_Time_Tmp),sysdate,(select count from Start_Time_Tmp) ,(select count(*) from swt_rpt_base.SF_Apttus__APTS_Agreement__c where SWT_INS_DT::date = sysdate::date),'Y';

Commit;

select do_tm_task('mergeout','swt_rpt_stg.SF_Apttus__APTS_Agreement__c_Hist');
select do_tm_task('mergeout','swt_rpt_base.SF_Apttus__APTS_Agreement__c');
select do_tm_task('mergeout','swt_rpt_stg.FAST_LD_AUDT');
select ANALYZE_STATISTICS('swt_rpt_base.SF_Apttus__APTS_Agreement__c');

